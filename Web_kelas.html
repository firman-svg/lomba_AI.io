<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Kelas XI-7 VALLORIX - SMA Negeri 4 Bojonegoro</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
   <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Poppins', sans-serif;
        }

        :root {
            /* Primary Colors - Purple Theme */
            --primary-color: #7c3aed;
            --primary-light: #8b5cf6;
            --primary-dark: #6d28d9;
            --primary-gradient: linear-gradient(135deg, var(--primary-color), var(--primary-light));
            
            /* Secondary Colors - Teal Theme */
            --secondary-color: #0d9488;
            --secondary-light: #14b8a6;
            --secondary-dark: #0f766e;
            --secondary-gradient: linear-gradient(135deg, var(--secondary-color), var(--secondary-light));
            
            /* Accent Colors */
            --accent-color: #f59e0b;
            --accent-light: #fbbf24;
            --accent-dark: #d97706;
            --accent-gradient: linear-gradient(135deg, var(--accent-color), var(--accent-light));
            
            /* Status Colors */
            --success-color: #10b981;
            --success-light: #34d399;
            --success-dark: #059669;
            
            --warning-color: #f59e0b;
            --warning-light: #fbbf24;
            --warning-dark: #d97706;
            
            --info-color: #3b82f6;
            --info-light: #60a5fa;
            --info-dark: #2563eb;
            
            --danger-color: #ef4444;
            --danger-light: #f87171;
            --danger-dark: #dc2626;
            
            /* Text Colors */
            --text-primary: #1f2937;
            --text-secondary: #374151;
            --text-tertiary: #6b7280;
            --text-inverse: #ffffff;
            
            /* Background Colors */
            --bg-primary: #ffffff;
            --bg-secondary: #f8fafc;
            --bg-tertiary: #f1f5f9;
            --bg-card: #ffffff;
            
            /* Border Colors */
            --border-primary: #e5e7eb;
            --border-secondary: #d1d5db;
            --border-accent: var(--primary-color);
            
            /* Shadow Colors */
            --shadow-light: 0 1px 3px rgba(0, 0, 0, 0.1);
            --shadow-medium: 0 4px 6px rgba(0, 0, 0, 0.1);
            --shadow-large: 0 10px 25px rgba(0, 0, 0, 0.1);
            --shadow-xl: 0 20px 25px rgba(0, 0, 0, 0.1);
            
            /* Overlay Colors */
            --overlay-light: rgba(255, 255, 255, 0.8);
            --overlay-dark: rgba(0, 0, 0, 0.1);
            
            /* Radius */
            --radius-sm: 8px;
            --radius-md: 12px;
            --radius-lg: 16px;
            --radius-xl: 20px;
            
            /* Transition */
            --transition: all 0.3s ease;
            --transition-slow: all 0.5s ease;
        }

        /* DARK MODE VARIABLES */
        .dark-mode {
            /* Primary Colors - Purple Theme */
            --primary-color: #8b5cf6;
            --primary-light: #a78bfa;
            --primary-dark: #7c3aed;
            --primary-gradient: linear-gradient(135deg, var(--primary-color), var(--primary-light));
            
            /* Secondary Colors - Teal Theme */
            --secondary-color: #14b8a6;
            --secondary-light: #2dd4bf;
            --secondary-dark: #0d9488;
            --secondary-gradient: linear-gradient(135deg, var(--secondary-color), var(--secondary-light));
            
            /* Accent Colors */
            --accent-color: #f59e0b;
            --accent-light: #fbbf24;
            --accent-dark: #d97706;
            --accent-gradient: linear-gradient(135deg, var(--accent-color), var(--accent-light));
            
            /* Status Colors */
            --success-color: #10b981;
            --success-light: #34d399;
            --success-dark: #059669;
            
            --warning-color: #f59e0b;
            --warning-light: #fbbf24;
            --warning-dark: #d97706;
            
            --info-color: #3b82f6;
            --info-light: #60a5fa;
            --info-dark: #2563eb;
            
            --danger-color: #ef4444;
            --danger-light: #f87171;
            --danger-dark: #dc2626;
            
            /* Text Colors */
            --text-primary: #f9fafb;
            --text-secondary: #e5e7eb;
            --text-tertiary: #9ca3af;
            --text-inverse: #1f2937;
            
            /* Background Colors */
            --bg-primary: #111827;
            --bg-secondary: #1f2937;
            --bg-tertiary: #374151;
            --bg-card: #1f2937;
            
            /* Border Colors */
            --border-primary: #374151;
            --border-secondary: #4b5563;
            --border-accent: var(--primary-color);
            
            /* Shadow Colors */
            --shadow-light: 0 1px 3px rgba(0, 0, 0, 0.3);
            --shadow-medium: 0 4px 6px rgba(0, 0, 0, 0.3);
            --shadow-large: 0 10px 25px rgba(0, 0, 0, 0.3);
            --shadow-xl: 0 20px 25px rgba(0, 0, 0, 0.3);
            
            /* Overlay Colors */
            --overlay-light: rgba(17, 24, 39, 0.8);
            --overlay-dark: rgba(0, 0, 0, 0.3);
        }

        body {
            background: linear-gradient(135deg, var(--bg-secondary), var(--bg-tertiary));
            color: var(--text-primary);
            line-height: 1.6;
            overflow-x: hidden;
            transition: var(--transition-slow);
        }

        /* Loading Screen */
        .loading-screen {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: var(--primary-gradient);
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 9999;
            transition: opacity 0.8s ease, visibility 0.8s ease;
        }

        .loading-screen.hidden {
            opacity: 0;
            visibility: hidden;
        }

        .loading-logo {
            width: 120px;
            height: 120px;
            background: rgba(255, 255, 255, 0.2);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 3rem;
            color: white;
            margin-bottom: 20px;
            backdrop-filter: blur(10px);
            border: 3px solid rgba(255, 255, 255, 0.3);
            box-shadow: var(--shadow-large);
            position: relative;
            overflow: hidden;
        }

        .loading-logo::after {
            content: '';
            position: absolute;
            top: -5px;
            left: -5px;
            right: -5px;
            bottom: -5px;
            background: linear-gradient(45deg, var(--primary-light), var(--accent-light), var(--secondary-light));
            border-radius: 50%;
            z-index: -1;
            animation: rotate 10s linear infinite;
        }

        .loading-text {
            color: white;
            font-size: 1.5rem;
            font-weight: 600;
            margin-bottom: 20px;
            text-align: center;
        }

        .loading-bar {
            width: 200px;
            height: 4px;
            background: rgba(255, 255, 255, 0.3);
            border-radius: 2px;
            overflow: hidden;
        }

        .loading-progress {
            height: 100%;
            width: 0%;
            background: white;
            border-radius: 2px;
            transition: width 0.5s ease;
        }

        .class-website {
            min-height: 100vh;
            opacity: 0;
            transform: translateY(20px);
            transition: opacity 0.8s ease, transform 0.8s ease;
        }

        .class-website.loaded {
            opacity: 1;
            transform: translateY(0);
        }

      /* Header Styles - REVISI */
.class-header {
    background: var(--primary-gradient);
    color: var(--text-inverse);
    padding: 30px 0;
    box-shadow: var(--shadow-large);
    position: relative;
    overflow: hidden;
    display: flex;
    align-items: center;
    min-height: 180px;
}

.class-header::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1000 100" fill="%23ffffff" opacity="0.05"><polygon points="0,0 1000,50 1000,100 0,100"/></svg>');
    background-size: cover;
}

/* Header Decoration Elements */
.header-decoration {
    position: absolute;
    border-radius: 50%;
    opacity: 0.1;
    animation: float 15s infinite ease-in-out;
}

.decoration-1 {
    width: 150px;
    height: 150px;
    background: white;
    top: -50px;
    left: -50px;
    animation-delay: 0s;
}

.decoration-2 {
    width: 100px;
    height: 100px;
    background: var(--accent-color);
    bottom: -30px;
    right: 10%;
    animation-delay: 2s;
}

.decoration-3 {
    width: 80px;
    height: 80px;
    background: var(--secondary-color);
    top: 20%;
    right: -30px;
    animation-delay: 4s;
}

/* Header Content - REVISI */
.header-content {
    max-width: 1200px;
    margin: 0 auto;
    padding: 0 20px;
    display: grid;
    grid-template-columns: 1fr auto 1fr;
    align-items: center;
    gap: 40px;
    position: relative;
    z-index: 1;
    width: 100%;
}

.class-info {
    display: flex;
    align-items: center;
    gap: 20px;
    justify-self: start;
}

.class-avatar {
    width: 100px;
    height: 100px;
    background: rgba(255, 255, 255, 0.2);
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 2.5rem;
    backdrop-filter: blur(10px);
    border: 3px solid rgba(255, 255, 255, 0.3);
    box-shadow: var(--shadow-large);
    overflow: hidden;
    position: relative;
}

.class-avatar img {
    width: 100%;
    height: 100%;
    object-fit: cover;
    border-radius: 50%;
}

.class-avatar::after {
    content: '';
    position: absolute;
    top: -5px;
    left: -5px;
    right: -5px;
    bottom: -5px;
    background: linear-gradient(45deg, var(--primary-light), var(--accent-light), var(--secondary-light));
    border-radius: 50%;
    z-index: -1;
    animation: rotate 10s linear infinite;
}

@keyframes rotate {
    0% { transform: rotate(0deg); }
    100% { transform: rotate(360deg); }
}

.class-details h1 {
    font-size: 2.5rem;
    margin-bottom: 5px;
    font-weight: 800;
    text-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
    background: linear-gradient(45deg, #ffffff, #e0f2fe);
    -webkit-background-clip: text;
    background-clip: text;
    -webkit-text-fill-color: transparent;
    color: transparent;
}

.class-details p {
    opacity: 0.9;
    font-size: 1.1rem;
}

/* Header Search Box - REVISI */
.header-search {
    position: relative;
    background: rgba(255, 255, 255, 0.15);
    border-radius: var(--radius-lg);
    padding: 12px 18px;
    display: flex;
    align-items: center;
    gap: 12px;
    width: 100%;
    max-width: 400px;
    margin: 0 auto;
    backdrop-filter: blur(10px);
    border: 1px solid rgba(255, 255, 255, 0.2);
    transition: var(--transition);
    transform: translateY(-15px); /* Posisi lebih ke atas */
    justify-self: center;
}

.header-search:focus-within {
    background: rgba(255, 255, 255, 0.25);
    border-color: rgba(255, 255, 255, 0.3);
    transform: translateY(-15px) scale(1.02);
    box-shadow: 0 8px 25px rgba(0, 0, 0, 0.15);
}

.header-search i {
    color: rgba(255, 255, 255, 0.8);
    font-size: 1.1rem;
}

.header-search input {
    border: none;
    outline: none;
    flex: 1;
    font-size: 1rem;
    background: transparent;
    color: white;
    font-weight: 400;
}

.header-search input::placeholder {
    color: rgba(255, 255, 255, 0.7);
}

/* Spacer untuk keseimbangan grid */
.header-spacer {
    justify-self: end;
}

/* Search Suggestions */
.search-suggestions {
    position: absolute;
    top: calc(100% + 5px);
    left: 0;
    right: 0;
    background: var(--bg-card);
    border-radius: var(--radius-md);
    box-shadow: var(--shadow-large);
    z-index: 1000;
    overflow: hidden;
    display: none;
    transform: translateY(-10px);
}

.search-suggestions.active {
    display: block;
    transform: translateY(0);
}

.suggestion-item {
    padding: 12px 15px;
    cursor: pointer;
    transition: var(--transition);
    border-bottom: 1px solid var(--border-primary);
    color: var(--text-primary);
}

.suggestion-item:hover {
    background: var(--bg-secondary);
}

.suggestion-item:last-child {
    border-bottom: none;
}

.suggestion-item i {
    margin-right: 10px;
    color: var(--primary-color);
}

/* Theme Toggle Button */
.theme-toggle {
    position: absolute;
    top: 20px;
    right: 20px;
    background: rgba(255, 255, 255, 0.2);
    border: none;
    width: 50px;
    height: 50px;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    color: white;
    font-size: 1.2rem;
    cursor: pointer;
    backdrop-filter: blur(10px);
    transition: var(--transition);
    z-index: 10;
}

.theme-toggle:hover {
    background: rgba(255, 255, 255, 0.3);
    transform: scale(1.1);
}

/* Responsive Design - REVISI untuk Header */
@media (max-width: 1024px) {
    .header-content {
        grid-template-columns: 1fr;
        gap: 25px;
        text-align: center;
    }
    
    .class-info {
        justify-self: center;
    }
    
    .header-search {
        max-width: 500px;
        transform: translateY(-10px);
        order: 2;
    }
    
    .header-search:focus-within {
        transform: translateY(-10px) scale(1.02);
    }
    
    .header-spacer {
        display: none;
    }
}

@media (max-width: 768px) {
    .class-header {
        padding: 25px 0;
        min-height: 160px;
    }
    
    .header-content {
        grid-template-columns: 1fr;
        gap: 20px;
    }
    
    .class-info {
        flex-direction: column;
        text-align: center;
        justify-self: center;
    }
    
    .header-search {
        min-width: 100%;
        margin-top: 10px;
        transform: translateY(-5px);
        order: 2;
    }
    
    .header-search:focus-within {
        transform: translateY(-5px) scale(1.02);
    }
    
    .class-details h1 {
        font-size: 2rem;
    }
    
    .class-avatar {
        width: 80px;
        height: 80px;
        font-size: 2rem;
    }
}

@media (max-width: 480px) {
    .class-header {
        padding: 20px 0;
        min-height: 140px;
    }
    
    .class-details h1 {
        font-size: 1.8rem;
    }
    
    .header-search {
        padding: 10px 15px;
        transform: translateY(0);
    }
    
    .header-search:focus-within {
        transform: translateY(0) scale(1.02);
    }
    
    .theme-toggle {
        width: 45px;
        height: 45px;
        font-size: 1.1rem;
    }
    
    .class-avatar {
        width: 70px;
        height: 70px;
        font-size: 1.8rem;
    }
}

        /* Navigation */
        .class-nav {
            background: var(--bg-card);
            border-bottom: 1px solid var(--border-primary);
            position: sticky;
            top: 0;
            z-index: 100;
            box-shadow: var(--shadow-medium);
            transition: var(--transition-slow);
        }

        .nav-container {
            max-width: 1200px;
            margin: 0 auto;
            display: flex;
            overflow-x: auto;
            scrollbar-width: none; /* Firefox */
            padding: 0 10px;
        }

        .nav-container::-webkit-scrollbar {
            display: none; /* Chrome, Safari, Edge */
        }

        .nav-item {
            padding: 20px 25px;
            text-decoration: none;
            color: var(--text-secondary);
            display: flex;
            align-items: center;
            gap: 10px;
            font-weight: 500;
            transition: var(--transition);
            border-bottom: 3px solid transparent;
            white-space: nowrap;
            cursor: pointer;
            position: relative;
        }

        .nav-item:hover {
            color: var(--primary-color);
            background: var(--bg-secondary);
        }

        .nav-item.active {
            color: var(--primary-color);
            border-bottom-color: var(--primary-color);
            background: rgba(139, 92, 246, 0.05);
        }

        .nav-item i {
            font-size: 1.1rem;
        }

        /* Main Content */
        .class-main {
            max-width: 1200px;
            margin: 0 auto;
            padding: 30px 20px;
            transition: var(--transition-slow);
        }

        .tab-content {
            display: none;
            animation: fadeInUp 0.5s ease-out;
        }

        @keyframes fadeInUp {
            from { 
                opacity: 0; 
                transform: translateY(30px); 
            }
            to { 
                opacity: 1; 
                transform: translateY(0); 
            }
        }

        .tab-content.active {
            display: block;
        }

        /* Halaman Utama Styles */
        .welcome-banner {
            background: linear-gradient(135deg, var(--bg-card), var(--bg-secondary));
            border-radius: var(--radius-lg);
            padding: 30px;
            margin-bottom: 30px;
            box-shadow: var(--shadow-medium);
            display: grid;
            grid-template-columns: 2fr 1fr;
            gap: 30px;
            align-items: start;
            position: relative;
            overflow: hidden;
            border: 1px solid var(--border-primary);
            transition: var(--transition-slow);
        }

        .welcome-banner::before {
            content: '';
            position: absolute;
            top: 0;
            right: 0;
            width: 150px;
            height: 150px;
            background: linear-gradient(135deg, var(--primary-light), var(--primary-color));
            border-radius: 0 0 0 100px;
            opacity: 0.05;
        }

        .welcome-text h2 {
            font-size: 2rem;
            margin-bottom: 10px;
            color: var(--text-primary);
            background: linear-gradient(45deg, var(--primary-color), var(--primary-light));
            -webkit-background-clip: text;
            background-clip: text;
            -webkit-text-fill-color: transparent;
            color: transparent;
        }

        .welcome-text p {
            color: var(--text-secondary);
            font-size: 1.1rem;
        }

        .class-announcement {
            background: linear-gradient(135deg, var(--warning-color), var(--accent-color));
            border: 1px solid var(--warning-color);
            border-radius: var(--radius-md);
            padding: 20px;
            position: relative;
            box-shadow: var(--shadow-medium);
            color: white;
        }

        .announcement-header {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 10px;
        }

        .announcement-header i {
            color: white;
            font-size: 1.2rem;
        }

        .announcement-header h3 {
            color: white;
            font-size: 1.2rem;
        }

        .announcement-content p {
            color: white;
            line-height: 1.5;
        }

        .edit-announcement-btn {
            position: absolute;
            top: 15px;
            right: 15px;
            background: rgba(255, 255, 255, 0.2);
            border: none;
            color: white;
            cursor: pointer;
            font-size: 0.9rem;
            display: flex;
            align-items: center;
            gap: 5px;
            transition: var(--transition);
            padding: 5px 10px;
            border-radius: var(--radius-sm);
        }

        .edit-announcement-btn:hover {
            background: rgba(255, 255, 255, 0.3);
        }

        /* Moto Kelas */
        .class-motto {
            background: var(--primary-gradient);
            color: white;
            padding: 30px;
            border-radius: var(--radius-lg);
            text-align: center;
            margin-bottom: 30px;
            font-style: italic;
            font-size: 1.5rem;
            box-shadow: var(--shadow-large);
            position: relative;
            overflow: hidden;
        }

        .class-motto::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1000 100" fill="%23ffffff" opacity="0.1"><polygon points="0,0 1000,50 1000,100 0,100"/></svg>');
            background-size: cover;
        }

        .class-motto p {
            position: relative;
            z-index: 1;
            text-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
        }

        /* Struktur Kelas */
        .class-structure {
            background: var(--bg-card);
            border-radius: var(--radius-lg);
            padding: 30px;
            box-shadow: var(--shadow-medium);
            margin-bottom: 30px;
            border: 1px solid var(--border-primary);
            transition: var(--transition);
        }

        .class-structure:hover {
            box-shadow: var(--shadow-large);
            transform: translateY(-2px);
        }

        .class-structure h3 {
            margin-bottom: 25px;
            color: var(--text-primary);
            font-size: 1.8rem;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .structure-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            gap: 25px;
        }

        .structure-card {
            background: var(--bg-secondary);
            border-radius: var(--radius-md);
            padding: 25px;
            text-align: center;
            transition: var(--transition);
            border: 1px solid var(--border-primary);
            position: relative;
            overflow: hidden;
        }

        .structure-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 5px;
            background: var(--primary-gradient);
        }

        .structure-card:hover {
            transform: translateY(-5px);
            box-shadow: var(--shadow-large);
        }

        .structure-avatar {
            width: 80px;
            height: 80px;
            background: var(--primary-color);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 1.5rem;
            margin: 0 auto 15px;
            box-shadow: var(--shadow-medium);
        }

        .structure-name {
            font-weight: 600;
            margin-bottom: 5px;
            color: var(--text-primary);
        }

        .structure-role {
            color: var(--primary-color);
            font-weight: 500;
            margin-bottom: 10px;
            font-size: 1.1rem;
        }

        .structure-contact {
            font-size: 0.9rem;
            color: var(--text-secondary);
        }

        /* Galeri Kenangan */
        .class-gallery {
            background: var(--bg-card);
            border-radius: var(--radius-lg);
            padding: 30px;
            box-shadow: var(--shadow-medium);
            margin-bottom: 30px;
            border: 1px solid var(--border-primary);
            transition: var(--transition);
        }

        .class-gallery:hover {
            box-shadow: var(--shadow-large);
            transform: translateY(-2px);
        }

        .class-gallery h3 {
            margin-bottom: 25px;
            color: var(--text-primary);
            font-size: 1.8rem;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .gallery-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 20px;
        }

        .gallery-item {
            border-radius: var(--radius-md);
            overflow: hidden;
            box-shadow: var(--shadow-medium);
            transition: var(--transition);
            cursor: pointer;
            aspect-ratio: 1;
            background: var(--bg-secondary);
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--text-secondary);
            position: relative;
            overflow: hidden;
        }

        .gallery-item::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, rgba(139, 92, 246, 0.1), rgba(6, 214, 160, 0.1));
            opacity: 0;
            transition: var(--transition);
        }

        .gallery-item:hover::before {
            opacity: 1;
        }

        .gallery-item:hover {
            transform: scale(1.05);
            box-shadow: var(--shadow-large);
        }

        .gallery-item i {
            font-size: 2.5rem;
            color: var(--primary-color);
        }

        .gallery-item-title {
            position: absolute;
            bottom: 0;
            left: 0;
            width: 100%;
            background: rgba(0, 0, 0, 0.7);
            color: white;
            padding: 10px;
            text-align: center;
            font-size: 0.9rem;
            transform: translateY(100%);
            transition: var(--transition);
        }

        .gallery-item:hover .gallery-item-title {
            transform: translateY(0);
        }

        /* Stats Section */
        .stats-section {
            background: var(--bg-card);
            border-radius: var(--radius-lg);
            padding: 25px;
            box-shadow: var(--shadow-medium);
            transition: var(--transition);
            border: 1px solid var(--border-primary);
            margin-bottom: 30px;
        }

        .stats-section:hover {
            box-shadow: var(--shadow-large);
            transform: translateY(-2px);
        }

        .stats-section h3 {
            margin-bottom: 20px;
            color: var(--text-primary);
            font-size: 1.3rem;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 15px;
        }

        .enhanced-stat-card {
            display: flex;
            align-items: center;
            gap: 15px;
            padding: 20px;
            border-radius: var(--radius-md);
            background: var(--bg-secondary);
            transition: var(--transition);
            cursor: pointer;
            position: relative;
            overflow: hidden;
        }

        .enhanced-stat-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, rgba(255,255,255,0.1), transparent);
            opacity: 0;
            transition: var(--transition);
        }

        .enhanced-stat-card:hover::before {
            opacity: 1;
        }

        .enhanced-stat-card:hover {
            transform: translateY(-5px);
            box-shadow: var(--shadow-medium);
        }

        .enhanced-stat-card.present { 
            border-left: 4px solid var(--success-color);
            background: linear-gradient(135deg, rgba(16, 185, 129, 0.05), transparent);
        }
        .enhanced-stat-card.sick { 
            border-left: 4px solid var(--warning-color);
            background: linear-gradient(135deg, rgba(245, 158, 11, 0.05), transparent);
        }
        .enhanced-stat-card.permission { 
            border-left: 4px solid var(--info-color);
            background: linear-gradient(135deg, rgba(59, 130, 246, 0.05), transparent);
        }
        .enhanced-stat-card.absent { 
            border-left: 4px solid var(--danger-color);
            background: linear-gradient(135deg, rgba(239, 68, 68, 0.05), transparent);
        }

        .stat-icon {
            width: 50px;
            height: 50px;
            border-radius: var(--radius-md);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.3rem;
            color: white;
        }

        .enhanced-stat-card.present .stat-icon { background: var(--success-color); }
        .enhanced-stat-card.sick .stat-icon { background: var(--warning-color); }
        .enhanced-stat-card.permission .stat-icon { background: var(--info-color); }
        .enhanced-stat-card.absent .stat-icon { background: var(--danger-color); }

        .stat-info h4 {
            font-size: 1.8rem;
            font-weight: 700;
            margin-bottom: 5px;
            color: var(--text-primary);
        }

        .stat-info span {
            color: var(--text-secondary);
            font-size: 0.9rem;
        }

        /* Today's Schedule */
        .schedule-section {
            background: var(--bg-card);
            border-radius: var(--radius-lg);
            padding: 25px;
            box-shadow: var(--shadow-medium);
            transition: var(--transition);
            border: 1px solid var(--border-primary);
            margin-bottom: 30px;
        }

        .schedule-section:hover {
            box-shadow: var(--shadow-large);
            transform: translateY(-2px);
        }

        .schedule-section h3 {
            margin-bottom: 20px;
            color: var(--text-primary);
            font-size: 1.3rem;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .today-schedule {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .enhanced-schedule-item {
            display: flex;
            align-items: center;
            gap: 15px;
            padding: 15px;
            border: 1px solid var(--border-primary);
            border-radius: var(--radius-md);
            transition: var(--transition);
            cursor: pointer;
            position: relative;
            overflow: hidden;
            background: var(--bg-secondary);
        }

        .enhanced-schedule-item::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 5px;
            height: 100%;
            background: var(--primary-color);
            transition: var(--transition);
        }

        .enhanced-schedule-item:hover::before {
            width: 8px;
            background: var(--secondary-color);
        }

        .enhanced-schedule-item:hover {
            transform: translateX(5px);
            box-shadow: var(--shadow-medium);
        }

        .enhanced-schedule-item.current {
            border-color: var(--primary-color);
            background: rgba(139, 92, 246, 0.05);
        }

        .enhanced-schedule-item.current::before {
            background: var(--secondary-color);
            width: 8px;
        }

        .schedule-time {
            font-weight: 600;
            color: var(--text-primary);
            min-width: 100px;
        }

        .schedule-details {
            flex: 1;
        }

        .schedule-details h4 {
            margin-bottom: 5px;
            color: var(--text-primary);
        }

        .schedule-details p {
            color: var(--text-secondary);
            font-size: 0.9rem;
        }

        .schedule-status {
            padding: 6px 12px;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: 600;
            background: var(--bg-secondary);
            color: var(--text-secondary);
        }

        .enhanced-schedule-item.current .schedule-status {
            background: var(--primary-color);
            color: white;
        }

        /* Teacher Status Badge */
        .teacher-status {
            position: absolute;
            top: 10px;
            right: 10px;
            padding: 4px 8px;
            border-radius: 12px;
            font-size: 0.7rem;
            font-weight: 600;
        }

        .teacher-present {
            background: var(--success-color);
            color: white;
        }

        .teacher-absent {
            background: var(--danger-color);
            color: white;
        }

        .edit-schedule-btn {
            position: absolute;
            bottom: 10px;
            right: 10px;
            background: none;
            border: none;
            color: var(--text-secondary);
            cursor: pointer;
            font-size: 0.8rem;
            display: flex;
            align-items: center;
            gap: 5px;
            transition: var(--transition);
            padding: 4px 8px;
            border-radius: var(--radius-sm);
        }

        .edit-schedule-btn:hover {
            color: var(--primary-color);
            background: rgba(139, 92, 246, 0.1);
        }

        /* Upcoming Assignments */
        .assignments-section {
            background: var(--bg-card);
            border-radius: var(--radius-lg);
            padding: 25px;
            box-shadow: var(--shadow-medium);
            transition: var(--transition);
            border: 1px solid var(--border-primary);
            margin-bottom: 30px;
        }

        .assignments-section:hover {
            box-shadow: var(--shadow-large);
            transform: translateY(-2px);
        }

        .assignments-section h3 {
            margin-bottom: 20px;
            color: var(--text-primary);
            font-size: 1.3rem;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .assignments-list {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }

        .enhanced-assignment-item {
            background: var(--bg-card);
            border-radius: var(--radius-md);
            padding: 20px;
            margin-bottom: 15px;
            box-shadow: var(--shadow-medium);
            border-left: 4px solid var(--info-color);
            transition: var(--transition);
            position: relative;
            overflow: hidden;
        }

        .enhanced-assignment-item::before {
            content: '';
            position: absolute;
            top: 0;
            right: 0;
            width: 0;
            height: 0;
            border-style: solid;
            border-width: 0 30px 30px 0;
            border-color: transparent rgba(139, 92, 246, 0.1) transparent transparent;
            transition: var(--transition);
        }

        .enhanced-assignment-item:hover::before {
            border-width: 0 40px 40px 0;
        }

        .enhanced-assignment-item:hover {
            transform: translateY(-3px);
            box-shadow: var(--shadow-large);
        }

        .enhanced-assignment-item.urgent {
            border-left-color: var(--danger-color);
            background: linear-gradient(135deg, rgba(239, 68, 68, 0.05), transparent);
        }

        .enhanced-assignment-item.completed {
            border-left-color: var(--success-color);
            background: linear-gradient(135deg, rgba(16, 185, 129, 0.05), transparent);
        }

        .assignment-subject {
            font-weight: 600;
            color: var(--primary-color);
            margin-bottom: 5px;
        }

        .assignment-title {
            font-weight: 500;
            margin-bottom: 8px;
            color: var(--text-primary);
        }

        .assignment-deadline {
            display: flex;
            align-items: center;
            gap: 5px;
            color: var(--text-secondary);
            font-size: 0.9rem;
        }

        .enhanced-assignment-item.urgent .assignment-deadline {
            color: var(--danger-color);
        }

        /* Recent Activity */
        .activity-section {
            background: var(--bg-card);
            border-radius: var(--radius-lg);
            padding: 25px;
            box-shadow: var(--shadow-medium);
            transition: var(--transition);
            border: 1px solid var(--border-primary);
            margin-bottom: 30px;
        }

        .activity-section:hover {
            box-shadow: var(--shadow-large);
            transform: translateY(-2px);
        }

        .activity-section h3 {
            margin-bottom: 20px;
            color: var(--text-primary);
            font-size: 1.3rem;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .activity-list {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .activity-item {
            display: flex;
            align-items: center;
            gap: 15px;
            padding: 15px;
            background: var(--bg-secondary);
            border-radius: var(--radius-md);
            transition: var(--transition);
            cursor: pointer;
        }

        .activity-item:hover {
            transform: translateX(5px);
            background: var(--bg-card);
            box-shadow: var(--shadow-medium);
        }

        .activity-icon {
            width: 40px;
            height: 40px;
            background: var(--primary-color);
            border-radius: var(--radius-md);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
        }

        .activity-content {
            flex: 1;
        }

        .activity-content p {
            font-weight: 500;
            margin-bottom: 4px;
            color: var(--text-primary);
        }

        .activity-time {
            font-size: 0.8rem;
            color: var(--text-secondary);
        }

        /* Today's Duty */
        .duty-section {
            background: var(--bg-card);
            border-radius: var(--radius-lg);
            padding: 25px;
            box-shadow: var(--shadow-medium);
            transition: var(--transition);
            border: 1px solid var(--border-primary);
            margin-bottom: 30px;
        }

        .duty-section:hover {
            box-shadow: var(--shadow-large);
            transform: translateY(-2px);
        }

        .duty-section h3 {
            margin-bottom: 20px;
            color: var(--text-primary);
            font-size: 1.3rem;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        /* Tab Header */
        .tab-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
            flex-wrap: wrap;
            gap: 15px;
        }

        .tab-header h2 {
            color: var(--text-primary);
            font-size: 1.8rem;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        /* Buttons */
        .btn-primary {
            background: var(--primary-gradient);
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: var(--radius-md);
            cursor: pointer;
            display: inline-flex;
            align-items: center;
            gap: 8px;
            font-weight: 500;
            transition: var(--transition);
            box-shadow: var(--shadow-medium);
        }

        .btn-primary:hover {
            background: linear-gradient(135deg, var(--primary-dark), var(--primary-color));
            transform: translateY(-2px);
            box-shadow: var(--shadow-large);
        }

        .btn-secondary {
            background: var(--bg-card);
            color: var(--text-primary);
            border: 1px solid var(--border-primary);
            padding: 10px 20px;
            border-radius: var(--radius-sm);
            cursor: pointer;
            transition: var(--transition);
            display: inline-flex;
            align-items: center;
            gap: 8px;
        }

        .btn-secondary:hover, .btn-secondary.active {
            background: var(--primary-color);
            color: white;
            border-color: var(--primary-color);
            transform: translateY(-1px);
            box-shadow: var(--shadow-medium);
        }

        .full-width {
            width: 100%;
        }

        /* Attendance Table */
        .attendance-controls {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            flex-wrap: wrap;
            gap: 15px;
        }

        .date-selector {
            display: flex;
            align-items: center;
            gap: 10px;
            flex-wrap: wrap;
        }

        .date-selector label {
            font-weight: 500;
            color: var(--text-primary);
        }

        .date-selector input {
            padding: 8px 12px;
            border: 1px solid var(--border-primary);
            border-radius: var(--radius-sm);
            transition: var(--transition);
            background: var(--bg-card);
            color: var(--text-primary);
        }

        .date-selector input:focus {
            outline: none;
            border-color: var(--primary-color);
            box-shadow: 0 0 0 3px rgba(139, 92, 246, 0.1);
        }

        .view-options {
            display: flex;
            gap: 5px;
        }

        .attendance-table-container {
            background: var(--bg-card);
            border-radius: var(--radius-md);
            overflow: hidden;
            box-shadow: var(--shadow-medium);
            margin-bottom: 20px;
            overflow-x: auto;
        }

        .attendance-table {
            width: 100%;
            border-collapse: collapse;
            min-width: 800px;
        }

        .attendance-table th {
            background: var(--bg-secondary);
            padding: 15px;
            text-align: left;
            font-weight: 600;
            color: var(--text-primary);
            border-bottom: 1px solid var(--border-primary);
        }

        .attendance-table td {
            padding: 15px;
            border-bottom: 1px solid var(--border-primary);
            color: var(--text-secondary);
        }

        .attendance-table tr:last-child td {
            border-bottom: none;
        }

        .attendance-table tr:hover {
            background: var(--bg-secondary);
        }

        /* Status Badges */
        .status-badge {
            padding: 6px 12px;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: 600;
        }

        .status-present { 
            background: rgba(16, 185, 129, 0.1); 
            color: var(--success-color);
            border: 1px solid rgba(16, 185, 129, 0.2);
        }
        .status-sick { 
            background: rgba(245, 158, 11, 0.1); 
            color: var(--warning-color);
            border: 1px solid rgba(245, 158, 11, 0.2);
        }
        .status-permission { 
            background: rgba(59, 130, 246, 0.1); 
            color: var(--info-color);
            border: 1px solid rgba(59, 130, 246, 0.2);
        }
        .status-absent { 
            background: rgba(239, 68, 68, 0.1); 
            color: var(--danger-color);
            border: 1px solid rgba(239, 68, 68, 0.2);
        }
        .status-not-filled { 
            background: rgba(107, 114, 128, 0.1); 
            color: var(--text-tertiary);
            border: 1px solid rgba(107, 114, 128, 0.2);
        }

        /* Modal Styles */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            z-index: 1000;
            backdrop-filter: blur(5px);
        }

        .modal-content {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: var(--bg-card);
            border-radius: var(--radius-lg);
            box-shadow: var(--shadow-xl);
            width: 90%;
            max-width: 600px;
            max-height: 90vh;
            overflow-y: auto;
        }

        .modal-header {
            padding: 25px;
            border-bottom: 1px solid var(--border-primary);
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .modal-header h3 {
            color: var(--text-primary);
            font-size: 1.5rem;
        }

        .close-btn {
            background: none;
            border: none;
            font-size: 1.2rem;
            color: var(--text-secondary);
            cursor: pointer;
            padding: 5px;
            border-radius: 4px;
            transition: var(--transition);
        }

        .close-btn:hover {
            background: var(--bg-secondary);
            color: var(--danger-color);
        }

        .modal-body {
            padding: 25px;
        }

        /* Form Styles */
        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 500;
            color: var(--text-primary);
        }

        .form-group input,
        .form-group select,
        .form-group textarea {
            width: 100%;
            padding: 12px 15px;
            border: 1px solid var(--border-primary);
            border-radius: var(--radius-sm);
            font-size: 1rem;
            transition: var(--transition);
            background: var(--bg-card);
            color: var(--text-primary);
        }

        .form-group input:focus,
        .form-group select:focus,
        .form-group textarea:focus {
            outline: none;
            border-color: var(--primary-color);
            box-shadow: 0 0 0 3px rgba(139, 92, 246, 0.1);
        }

        /* Students Attendance List */
        .students-attendance-list h4 {
            margin-bottom: 15px;
            color: var(--text-primary);
        }

        .attendance-student-item {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 12px;
            border: 1px solid var(--border-primary);
            border-radius: var(--radius-sm);
            margin-bottom: 10px;
            transition: var(--transition);
            background: var(--bg-secondary);
        }

        .attendance-student-item:hover {
            background: var(--bg-card);
        }

        .student-attendance-info {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .student-avatar-small {
            width: 35px;
            height: 35px;
            background: var(--primary-color);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: 600;
            font-size: 0.9rem;
        }

        .attendance-options-small {
            display: flex;
            gap: 8px;
        }

        .attendance-btn-small {
            padding: 6px 12px;
            border: 1px solid var(--border-primary);
            border-radius: var(--radius-sm);
            background: var(--bg-card);
            cursor: pointer;
            font-size: 0.8rem;
            transition: var(--transition);
            color: var(--text-secondary);
        }

        .attendance-btn-small.active {
            color: white;
        }

        .attendance-btn-small.present.active { background: var(--success-color); border-color: var(--success-color); }
        .attendance-btn-small.sick.active { background: var(--warning-color); border-color: var(--warning-color); }
        .attendance-btn-small.permission.active { background: var(--info-color); border-color: var(--info-color); }
        .attendance-btn-small.absent.active { background: var(--danger-color); border-color: var(--danger-color); }

        /* Students Grid */
        .students-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            gap: 20px;
        }

        .student-card {
            background: var(--bg-card);
            border-radius: var(--radius-md);
            padding: 20px;
            box-shadow: var(--shadow-medium);
            text-align: center;
            transition: var(--transition);
            cursor: pointer;
            border: 1px solid var(--border-primary);
        }

        .student-card:hover {
            transform: translateY(-5px);
            box-shadow: var(--shadow-large);
        }

        .student-avatar-large {
            width: 80px;
            height: 80px;
            background: var(--primary-color);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 1.5rem;
            font-weight: 600;
            margin: 0 auto 15px;
        }

        .student-card h4 {
            margin-bottom: 5px;
            color: var(--text-primary);
        }

        .student-nis {
            color: var(--text-secondary);
            margin-bottom: 10px;
            font-size: 0.9rem;
        }

        .student-contact {
            font-size: 0.9rem;
            color: var(--text-secondary);
        }

        /* Teachers Grid */
        .teachers-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 25px;
        }

        .teacher-card {
            background: var(--bg-card);
            border-radius: var(--radius-md);
            padding: 25px;
            box-shadow: var(--shadow-medium);
            display: flex;
            align-items: center;
            gap: 20px;
            transition: var(--transition);
            cursor: pointer;
            border: 1px solid var(--border-primary);
        }

        .teacher-card:hover {
            transform: translateY(-5px);
            box-shadow: var(--shadow-large);
        }

        .teacher-avatar {
            width: 70px;
            height: 70px;
            background: var(--secondary-color);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 1.3rem;
        }

        .teacher-info h4 {
            margin-bottom: 5px;
            color: var(--text-primary);
        }

        .teacher-subject {
            color: var(--primary-color);
            font-weight: 600;
            margin-bottom: 8px;
        }

        .teacher-qualification {
            color: var(--text-secondary);
            font-size: 0.9rem;
        }

        /* Weekly Schedule */
        .weekly-schedule {
            background: var(--bg-card);
            border-radius: var(--radius-md);
            overflow: hidden;
            box-shadow: var(--shadow-medium);
            overflow-x: auto;
        }

        .schedule-days {
            display: grid;
            grid-template-columns: 120px repeat(6, 1fr);
            background: var(--primary-color);
            color: white;
            min-width: 800px;
        }

        .day-header {
            padding: 15px;
            text-align: center;
            font-weight: 600;
        }

        .day-header:first-child {
            background: var(--primary-dark);
        }

        .schedule-grid {
            display: grid;
            grid-template-columns: 120px repeat(6, 1fr);
            min-width: 800px;
        }

        .schedule-cell {
            padding: 15px;
            border: 1px solid var(--border-primary);
            min-height: 80px;
            background: var(--bg-card);
        }

        .schedule-cell.time {
            background: var(--bg-secondary);
            font-weight: 600;
            text-align: center;
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--text-primary);
        }

        .schedule-lesson {
            background: rgba(139, 92, 246, 0.1);
            border: 1px solid var(--primary-color);
            border-radius: var(--radius-sm);
            padding: 10px;
            margin-bottom: 5px;
            cursor: pointer;
            transition: var(--transition);
            position: relative;
        }

        .schedule-lesson:hover {
            transform: scale(1.02);
            background: rgba(139, 92, 246, 0.15);
        }

        .schedule-lesson h5 {
            margin-bottom: 5px;
            color: var(--text-primary);
        }

        .schedule-lesson p {
            font-size: 0.8rem;
            color: var(--text-secondary);
        }

        .schedule-lesson-actions {
            position: absolute;
            top: 5px;
            right: 5px;
            display: flex;
            gap: 5px;
        }

        .schedule-edit-btn {
            background: none;
            border: none;
            color: var(--text-secondary);
            cursor: pointer;
            font-size: 0.7rem;
            padding: 2px 5px;
            border-radius: 4px;
            transition: var(--transition);
        }

        .schedule-edit-btn:hover {
            color: var(--primary-color);
            background: rgba(139, 92, 246, 0.1);
        }

        /* Search Box */
        .search-box {
            position: relative;
            background: var(--bg-card);
            border: 1px solid var(--border-primary);
            border-radius: var(--radius-sm);
            padding: 10px 15px;
            display: flex;
            align-items: center;
            gap: 10px;
            min-width: 300px;
            transition: var(--transition);
        }

        .search-box:focus-within {
            border-color: var(--primary-color);
            box-shadow: 0 0 0 3px rgba(139, 92, 246, 0.1);
        }

        .search-box i {
            color: var(--text-secondary);
        }

        .search-box input {
            border: none;
            outline: none;
            flex: 1;
            font-size: 1rem;
            background: transparent;
            color: var(--text-primary);
        }

        /* Assignment Detailed */
        .assignment-item-detailed {
            background: var(--bg-card);
            border-radius: var(--radius-md);
            padding: 20px;
            margin-bottom: 15px;
            box-shadow: var(--shadow-medium);
            border-left: 4px solid var(--info-color);
            transition: var(--transition);
            position: relative;
            border: 1px solid var(--border-primary);
        }

        .assignment-item-detailed:hover {
            transform: translateY(-3px);
            box-shadow: var(--shadow-large);
        }

        .assignment-item-detailed.urgent {
            border-left-color: var(--danger-color);
            background: linear-gradient(135deg, rgba(239, 68, 68, 0.05), transparent);
        }

        .assignment-item-detailed.completed {
            border-left-color: var(--success-color);
            background: linear-gradient(135deg, rgba(16, 185, 129, 0.05), transparent);
        }

        .assignment-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
        }

        .assignment-status {
            padding: 6px 12px;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: 600;
        }

        .assignment-status.urgent {
            background: rgba(239, 68, 68, 0.1);
            color: var(--danger-color);
            border: 1px solid rgba(239, 68, 68, 0.2);
        }

        .assignment-status.active {
            background: rgba(59, 130, 246, 0.1);
            color: var(--info-color);
            border: 1px solid rgba(59, 130, 246, 0.2);
        }

        .assignment-status.completed {
            background: rgba(16, 185, 129, 0.1);
            color: var(--success-color);
            border: 1px solid rgba(16, 185, 129, 0.2);
        }

        .assignment-footer {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-top: 15px;
        }

        .assignment-actions {
            display: flex;
            gap: 10px;
        }

        .btn-small {
            padding: 6px 12px;
            border: 1px solid var(--border-primary);
            border-radius: var(--radius-sm);
            background: var(--bg-card);
            cursor: pointer;
            font-size: 0.8rem;
            transition: var(--transition);
            display: inline-flex;
            align-items: center;
            gap: 5px;
            color: var(--text-secondary);
        }

        .btn-small:hover {
            background: var(--primary-color);
            color: white;
            transform: translateY(-1px);
        }

        /* Assignment Filters */
        .assignment-filters {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
        }

        .filter-btn {
            padding: 8px 16px;
            border: 1px solid var(--border-primary);
            border-radius: var(--radius-sm);
            background: var(--bg-card);
            cursor: pointer;
            transition: var(--transition);
            display: inline-flex;
            align-items: center;
            gap: 5px;
            color: var(--text-secondary);
        }

        .filter-btn.active, .filter-btn:hover {
            background: var(--primary-color);
            color: white;
            border-color: var(--primary-color);
            transform: translateY(-1px);
            box-shadow: var(--shadow-medium);
        }

        /* Export Button */
        .export-btn {
            background: var(--secondary-gradient);
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: var(--radius-sm);
            cursor: pointer;
            display: inline-flex;
            align-items: center;
            gap: 8px;
            font-weight: 500;
            transition: var(--transition);
            box-shadow: var(--shadow-medium);
        }

        .export-btn:hover {
            background: linear-gradient(135deg, var(--secondary-dark), var(--secondary-color));
            transform: translateY(-2px);
            box-shadow: var(--shadow-large);
        }

        /* Toast Notification */
        .toast {
            position: fixed;
            bottom: 20px;
            right: 20px;
            background: var(--success-color);
            color: white;
            padding: 15px 25px;
            border-radius: var(--radius-sm);
            box-shadow: var(--shadow-large);
            z-index: 2000;
            opacity: 0;
            transform: translateX(100px);
            transition: var(--transition-slow);
        }

        .toast.show {
            opacity: 1;
            transform: translateX(0);
        }

        .toast.error {
            background: var(--danger-color);
        }

        /* Empty State */
        .empty-placeholder {
            text-align: center;
            padding: 40px;
            color: var(--text-secondary);
            border: 1px dashed var(--border-primary);
            border-radius: var(--radius-md);
            margin: 20px 0;
            background: var(--bg-secondary);
        }

        .empty-placeholder i {
            color: var(--primary-color);
            font-size: 2rem;
            margin-bottom: 10px;
        }

        /* Attendance Summary */
        .attendance-summary {
            background: var(--bg-card);
            border-radius: var(--radius-md);
            padding: 20px;
            box-shadow: var(--shadow-medium);
            border: 1px solid var(--border-primary);
        }

        .summary-card h4 {
            margin-bottom: 15px;
            color: var(--text-primary);
        }

        .summary-stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
        }

        .summary-item {
            display: flex;
            justify-content: space-between;
            padding: 10px;
            border-bottom: 1px solid var(--border-primary);
        }

        .summary-item .label {
            color: var(--text-secondary);
        }

        .summary-item .value {
            font-weight: 600;
            color: var(--text-primary);
        }

        .summary-item .value.present {
            color: var(--success-color);
        }

        .summary-item .value.absent {
            color: var(--danger-color);
        }

        /* Group Spinner Styles */
        .group-spinner-section {
            background: var(--bg-card);
            border-radius: var(--radius-lg);
            padding: 25px;
            box-shadow: var(--shadow-medium);
            margin-bottom: 25px;
            border: 1px solid var(--border-primary);
            transition: var(--transition);
        }

        .group-spinner-section:hover {
            box-shadow: var(--shadow-large);
            transform: translateY(-2px);
        }

        .group-controls {
            display: flex;
            gap: 15px;
            margin-bottom: 20px;
            flex-wrap: wrap;
            align-items: end;
        }

        .group-control-item {
            display: flex;
            flex-direction: column;
            gap: 5px;
        }

        .group-control-item label {
            font-size: 0.8rem;
            font-weight: 600;
            color: var(--text-secondary);
        }

        .group-control-item input, .group-control-item select {
            padding: 8px 12px;
            border: 1px solid var(--border-primary);
            border-radius: var(--radius-sm);
            transition: var(--transition);
            background: var(--bg-card);
            color: var(--text-primary);
        }

        .group-control-item input:focus, .group-control-item select:focus {
            outline: none;
            border-color: var(--primary-color);
            box-shadow: 0 0 0 3px rgba(139, 92, 246, 0.1);
        }

        .groups-container {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }

        .group-card {
            background: var(--bg-card);
            border-radius: var(--radius-md);
            padding: 20px;
            box-shadow: var(--shadow-medium);
            border: 1px solid var(--border-primary);
            transition: var(--transition);
        }

        .group-card:hover {
            transform: translateY(-5px);
            box-shadow: var(--shadow-large);
        }

        .group-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 1px solid var(--border-primary);
        }

        .group-name {
            font-weight: 600;
            color: var(--primary-color);
            font-size: 1.1rem;
        }

        .group-member-count {
            background: var(--primary-color);
            color: white;
            padding: 4px 10px;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: 600;
        }

        .group-members {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }

        .group-member {
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 8px;
            border-radius: var(--radius-sm);
            background: var(--bg-secondary);
            transition: var(--transition);
        }

        .group-member:hover {
            background: var(--bg-card);
        }

        .group-member-avatar {
            width: 30px;
            height: 30px;
            background: var(--primary-color);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 0.8rem;
            font-weight: 600;
        }

        .group-actions {
            display: flex;
            gap: 10px;
            margin-top: 20px;
        }

        /* Spinner Animation */
        .spinner-container {
            display: none;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 40px;
            background: var(--bg-card);
            border-radius: var(--radius-md);
            box-shadow: var(--shadow-medium);
            margin: 20px 0;
            border: 1px solid var(--border-primary);
        }

        .spinner {
            width: 60px;
            height: 60px;
            border: 5px solid var(--bg-secondary);
            border-top: 5px solid var(--primary-color);
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin-bottom: 20px;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .spinner-text {
            color: var(--text-secondary);
            font-weight: 500;
        }

        /* Floating Action Button */
        .fab {
            position: fixed;
            bottom: 30px;
            right: 30px;
            width: 60px;
            height: 60px;
            background: var(--primary-gradient);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 1.5rem;
            box-shadow: var(--shadow-large);
            cursor: pointer;
            z-index: 99;
            transition: var(--transition);
        }

        .fab:hover {
            transform: scale(1.1);
            box-shadow: var(--shadow-xl);
        }

        /* Quick Actions Menu */
        .quick-action-item {
            position: fixed;
            background: var(--bg-card);
            padding: 12px 16px;
            border-radius: var(--radius-md);
            box-shadow: var(--shadow-large);
            display: flex;
            align-items: center;
            gap: 10px;
            cursor: pointer;
            z-index: 98;
            animation: slideInRight 0.3s ease-out both;
            transition: var(--transition);
            color: var(--text-primary);
            border: 1px solid var(--border-primary);
        }

        .quick-action-item:hover {
            background: var(--primary-color);
            color: white;
            transform: translateX(-5px);
        }

        @keyframes slideInRight {
            from {
                opacity: 0;
                transform: translateX(50px);
            }
            to {
                opacity: 1;
                transform: translateX(0);
            }
        }

        /* Animated Background Elements */
        .animated-bg-element {
            position: absolute;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.1);
            animation: float 15s infinite ease-in-out;
            z-index: 0;
        }

        @keyframes float {
            0%, 100% { transform: translateY(0) rotate(0deg); }
            50% { transform: translateY(-20px) rotate(180deg); }
        }

        /* NEW: Classroom Layout Styles */
        .classroom-layout {
            background: var(--bg-card);
            border-radius: var(--radius-lg);
            padding: 25px;
            box-shadow: var(--shadow-medium);
            margin-bottom: 25px;
            overflow-x: auto;
            border: 1px solid var(--border-primary);
            transition: var(--transition);
        }

        .classroom-layout:hover {
            box-shadow: var(--shadow-large);
            transform: translateY(-2px);
        }

        .classroom-grid {
            display: grid;
            grid-template-columns: repeat(6, 1fr);
            gap: 15px;
            margin-bottom: 20px;
            min-width: 800px;
        }

        .classroom-desk {
            background: var(--bg-secondary);
            border-radius: var(--radius-md);
            padding: 15px;
            text-align: center;
            box-shadow: var(--shadow-medium);
            transition: var(--transition);
            cursor: pointer;
            border: 2px solid transparent;
        }

        .classroom-desk:hover {
            transform: translateY(-3px);
            box-shadow: var(--shadow-medium);
            border-color: var(--primary-color);
        }

        .classroom-desk.empty {
            background: var(--bg-tertiary);
            color: var(--text-tertiary);
        }

        .classroom-desk.teacher {
            background: var(--primary-gradient);
            color: white;
            grid-column: 3 / 5;
        }

        .desk-number {
            font-size: 0.8rem;
            font-weight: 600;
            margin-bottom: 5px;
            color: var(--text-secondary);
        }

        .classroom-desk.teacher .desk-number {
            color: rgba(255, 255, 255, 0.8);
        }

        .desk-student {
            font-size: 0.9rem;
            font-weight: 500;
            color: var(--text-primary);
        }

        .classroom-controls {
            display: flex;
            gap: 15px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }

        /* NEW: Duty Schedule Styles */
        .duty-schedule {
            background: var(--bg-card);
            border-radius: var(--radius-lg);
            padding: 25px;
            box-shadow: var(--shadow-medium);
            margin-bottom: 25px;
            border: 1px solid var(--border-primary);
            transition: var(--transition);
        }

        .duty-schedule:hover {
            box-shadow: var(--shadow-large);
            transform: translateY(-2px);
        }

        .duty-controls {
            display: flex;
            gap: 15px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }

        .duty-table {
            width: 100%;
            border-collapse: collapse;
        }

        .duty-table th {
            background: var(--bg-secondary);
            padding: 12px 15px;
            text-align: left;
            font-weight: 600;
            color: var(--text-primary);
            border-bottom: 1px solid var(--border-primary);
        }

        .duty-table td {
            padding: 12px 15px;
            border-bottom: 1px solid var(--border-primary);
            color: var(--text-secondary);
        }

        .duty-table tr:last-child td {
            border-bottom: none;
        }

        .duty-table tr:hover {
            background: var(--bg-secondary);
        }

        /* NEW: Subject Attendance Styles */
        .subject-attendance-section {
            background: var(--bg-card);
            border-radius: var(--radius-lg);
            padding: 25px;
            box-shadow: var(--shadow-medium);
            margin-bottom: 25px;
            border: 1px solid var(--border-primary);
            transition: var(--transition);
        }

        .subject-attendance-section:hover {
            box-shadow: var(--shadow-large);
            transform: translateY(-2px);
        }

        .subject-attendance-controls {
            display: flex;
            gap: 15px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }

        .subject-attendance-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 20px;
        }

        .subject-attendance-card {
            background: var(--bg-card);
            border-radius: var(--radius-md);
            padding: 20px;
            box-shadow: var(--shadow-medium);
            border-left: 4px solid var(--primary-color);
            transition: var(--transition);
            cursor: pointer;
            border: 1px solid var(--border-primary);
        }

        .subject-attendance-card:hover {
            transform: translateY(-5px);
            box-shadow: var(--shadow-large);
        }

        .subject-attendance-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }

        .subject-name {
            font-weight: 600;
            color: var(--primary-color);
            font-size: 1.1rem;
        }

        .subject-attendance-stats {
            display: flex;
            justify-content: space-between;
            margin-top: 15px;
        }

        .subject-stat {
            text-align: center;
        }

        .subject-stat-value {
            font-size: 1.5rem;
            font-weight: 700;
            margin-bottom: 5px;
        }

        .subject-stat-label {
            font-size: 0.8rem;
            color: var(--text-secondary);
        }

        /* Responsive Design */
        @media (max-width: 1024px) {
            .stats-grid {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .welcome-banner {
                grid-template-columns: 1fr;
            }
        }

        @media (max-width: 768px) {
            .header-content {
                flex-direction: column;
                text-align: center;
            }
            
            .class-info {
                flex-direction: column;
                text-align: center;
            }
            
            .header-search {
                min-width: 100%;
                margin-top: 15px;
            }
            
            .nav-container {
                justify-content: flex-start;
            }
            
            .tab-header {
                flex-direction: column;
                align-items: flex-start;
            }
            
            .attendance-controls {
                flex-direction: column;
                align-items: flex-start;
            }
            
            .stats-grid {
                grid-template-columns: 1fr;
            }
            
            .students-grid {
                grid-template-columns: 1fr;
            }
            
            .teachers-grid {
                grid-template-columns: 1fr;
            }
            
            .schedule-days, .schedule-grid {
                grid-template-columns: 80px repeat(6, 1fr);
                font-size: 0.8rem;
            }
            
            .group-controls, .duty-controls, .classroom-controls {
                flex-direction: column;
                align-items: stretch;
            }
            
            .group-control-item {
                width: 100%;
            }
            
            .search-box {
                min-width: 100%;
            }
            
            .class-details h1 {
                font-size: 2rem;
            }
            
            .class-avatar {
                width: 80px;
                height: 80px;
            }
            
            .classroom-grid {
                grid-template-columns: repeat(4, 1fr);
                min-width: 600px;
            }
            
            .structure-grid {
                grid-template-columns: 1fr;
            }
        }

        @media (max-width: 480px) {
            .class-details h1 {
                font-size: 1.8rem;
            }
            
            .enhanced-schedule-item {
                flex-direction: column;
                align-items: flex-start;
                gap: 10px;
            }
            
            .schedule-time {
                min-width: auto;
            }
            
            .attendance-table {
                font-size: 0.8rem;
            }
            
            .attendance-table th,
            .attendance-table td {
                padding: 10px 8px;
            }
            
            .group-header {
                flex-direction: column;
                align-items: flex-start;
                gap: 10px;
            }
            
            .group-actions {
                flex-direction: column;
            }
            
            .nav-item {
                padding: 15px 20px;
            }
            
            .class-main {
                padding: 20px 15px;
            }
            
            .welcome-banner, .stats-section, .schedule-section, .assignments-section, .activity-section, .duty-section {
                padding: 20px;
            }
            
            .tab-header h2 {
                font-size: 1.5rem;
            }
            
            .classroom-grid {
                grid-template-columns: repeat(3, 1fr);
                min-width: 450px;
            }
        }
    </style>
</head>
<body>
    <!-- Loading Screen -->
    <div class="loading-screen" id="loadingScreen">
        <div class="loading-logo">
            <i class="fas fa-graduation-cap"></i>
        </div>
        <div class="loading-text">Kelas XI-7 VALLORIX</div>
        <div class="loading-bar">
            <div class="loading-progress" id="loadingProgress"></div>
        </div>
    </div>

    <div class="class-website" id="classWebsite">
        <!-- Header -->
        <header class="class-header">
            <!-- Theme Toggle Button -->
            <button class="theme-toggle" id="themeToggle">
                <i class="fas fa-moon"></i>
            </button>
            
            <!-- Header Decoration Elements -->
            <div class="header-decoration decoration-1"></div>
            <div class="header-decoration decoration-2"></div>
            <div class="header-decoration decoration-3"></div>
            
            <div class="header-content">
                <div class="class-info">
                    <div class="class-avatar">
                        <!-- Logo kelas akan dimuat di sini -->
                        <i class="fas fa-graduation-cap"></i>
                    </div>
                    <div class="class-details">
                        <h1>Kelas XI-7 VALLORIX</h1>
                        <p>SMA Negeri 4 Bojonegoro  Tahun Ajaran 2024/2025</p>
                    </div>
                </div>
                
                <!-- Header Search Box -->
                <div class="header-search">
                    <i class="fas fa-search"></i>
                    <input type="text" placeholder="Cari halaman atau fitur..." id="headerSearch">
                    <div class="search-suggestions" id="searchSuggestions">
                        <!-- Search suggestions will be loaded here -->
                    </div>
                </div>
            </div>
        </header>
        
        <!-- Navigation -->
        <nav class="class-nav">
            <div class="nav-container">
                <a href="#home" class="nav-item active" data-tab="home">
                    <i class="fas fa-home"></i>
                    <span>Halaman Utama</span>
                </a>
                <a href="#attendance" class="nav-item" data-tab="attendance">
                    <i class="fas fa-clipboard-check"></i>
                    <span>Absensi Harian</span>
                </a>
                <a href="#subject-attendance" class="nav-item" data-tab="subject-attendance">
                    <i class="fas fa-book"></i>
                    <span>Absensi Mata Pelajaran</span>
                </a>
                <a href="#group-spinner" class="nav-item" data-tab="group-spinner">
                    <i class="fas fa-random"></i>
                    <span>Pembagian Kelompok</span>
                </a>
                <a href="#classroom" class="nav-item" data-tab="classroom">
                    <i class="fas fa-chair"></i>
                    <span>Tata Letak Kelas</span>
                </a>
                <a href="#duty" class="nav-item" data-tab="duty">
                    <i class="fas fa-broom"></i>
                    <span>Jadwal Piket</span>
                </a>
                <a href="#schedule" class="nav-item" data-tab="schedule">
                    <i class="fas fa-calendar-alt"></i>
                    <span>Jadwal</span>
                </a>
                <a href="#students" class="nav-item" data-tab="students">
                    <i class="fas fa-user-graduate"></i>
                    <span>Siswa</span>
                </a>
                <a href="#teachers" class="nav-item" data-tab="teachers">
                    <i class="fas fa-chalkboard-teacher"></i>
                    <span>Guru</span>
                </a>
                <a href="#assignments" class="nav-item" data-tab="assignments">
                    <i class="fas fa-tasks"></i>
                    <span>Tugas</span>
                </a>
            </div>
        </nav>
        
        <!-- Main Content -->
        <main class="class-main">
            <!-- Halaman Utama Tab -->
            <div id="home" class="tab-content active">
                <div class="welcome-banner">
                    <div class="welcome-text">
                        <h2>Selamat Datang di Kelas XI-7 VALLORIX! </h2>
                        <p>Platform digital untuk pembelajaran dan manajemen kelas</p>
                    </div>
                    <div class="class-announcement">
                        <div class="announcement-header">
                            <i class="fas fa-bullhorn"></i>
                            <h3>Pengumuman</h3>
                            <button class="edit-announcement-btn" onclick="app.editAnnouncement()">
                                <i class="fas fa-edit"></i> Edit
                            </button>
                        </div>
                        <div class="announcement-content">
                            <p id="announcementText">Persiapan Ujian Tengah Semester akan dimulai minggu depan. Mari persiapkan dengan baik!</p>
                        </div>
                    </div>
                </div>
                
                <!-- Moto Kelas -->
                <div class="class-motto">
                    <p>"Bersatu dalam Perbedaan, Berprestasi dalam Kebersamaan"</p>
                </div>
                
                <!-- Struktur Kelas -->
                <div class="class-structure">
                    <h3><i class="fas fa-users"></i> Struktur Kelas XI-7 VALLORIX</h3>
                    <div class="structure-grid" id="structureGrid">
                        <!-- Struktur kelas akan dimuat di sini -->
                    </div>
                </div>
                
                <!-- Galeri Kenangan -->
                <div class="class-gallery">
                    <h3><i class="fas fa-images"></i> Galeri Kenangan</h3>
                    <div class="gallery-grid" id="galleryGrid">
                        <!-- Galeri akan dimuat di sini -->
                    </div>
                </div>
                
                <!-- Statistik Hari Ini -->
                <div class="stats-section">
                    <h3><i class="fas fa-chart-bar"></i> Statistik Absensi Harian</h3>
                    <div class="stats-grid">
                        <div class="enhanced-stat-card present" onclick="app.showAttendanceDetails('present')">
                            <div class="stat-icon">
                                <i class="fas fa-user-check" style="color: white;"></i>
                            </div>
                            <div class="stat-info">
                                <h4 id="presentCount">0</h4>
                                <span>Hadir</span>
                            </div>
                        </div>
                        <div class="enhanced-stat-card sick" onclick="app.showAttendanceDetails('sick')">
                            <div class="stat-icon">
                                <i class="fas fa-procedures" style="color: white;"></i>
                            </div>
                            <div class="stat-info">
                                <h4 id="sickCount">0</h4>
                                <span>Sakit</span>
                            </div>
                        </div>
                        <div class="enhanced-stat-card permission" onclick="app.showAttendanceDetails('permission')">
                            <div class="stat-icon">
                                <i class="fas fa-envelope" style="color: white;"></i>
                            </div>
                            <div class="stat-info">
                                <h4 id="permissionCount">0</h4>
                                <span>Izin</span>
                            </div>
                        </div>
                        <div class="enhanced-stat-card absent" onclick="app.showAttendanceDetails('absent')">
                            <div class="stat-icon">
                                <i class="fas fa-user-times" style="color: white;"></i>
                            </div>
                            <div class="stat-info">
                                <h4 id="absentCount">36</h4>
                                <span>Alpha</span>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Jadwal Hari Ini -->
                <div class="schedule-section">
                    <h3><i class="fas fa-calendar-day"></i> Jadwal Hari Ini</h3>
                    <div class="today-schedule" id="todaySchedule">
                        <!-- Jadwal hari ini akan dimuat di sini -->
                    </div>
                </div>
                
                <!-- Tugas Mendatang -->
                <div class="assignments-section">
                    <h3><i class="fas fa-tasks"></i> Tugas Mendatang</h3>
                    <div class="assignments-list" id="dashboardAssignmentsList">
                        <!-- Tugas akan dimuat secara dinamis -->
                    </div>
                </div>
                
                <!-- Aktivitas Terbaru -->
                <div class="activity-section">
                    <h3><i class="fas fa-history"></i> Aktivitas Terbaru</h3>
                    <div class="activity-list" id="recentActivityList">
                        <!-- Aktivitas terbaru akan dimuat di sini -->
                    </div>
                </div>
                
                <!-- Piket Hari Ini -->
                <div class="duty-section">
                    <h3><i class="fas fa-broom"></i> Piket Hari Ini</h3>
                    <div id="todayDutyList">
                        <!-- Piket hari ini akan dimuat di sini -->
                    </div>
                </div>
            </div>
            
            <!-- Attendance Tab -->
            <div id="attendance" class="tab-content">
                <div class="tab-header">
                    <h2>Absensi Harian Kelas XI-7 VALLORIX</h2>
                    <div>
                        <button class="export-btn" onclick="app.exportAttendance()">
                            <i class="fas fa-file-export"></i>
                            Ekspor Data
                        </button>
                        <button class="btn-primary" onclick="app.showAttendanceModal('daily')">
                            <i class="fas fa-plus"></i>
                            Input Absensi Harian
                        </button>
                    </div>
                </div>
                <div class="attendance-controls">
                    <div class="date-selector">
                        <label for="attendanceDate">Pilih Tanggal:</label>
                        <input type="date" id="attendanceDate">
                    </div>
                    <div class="view-options">
                        <button class="btn-secondary active">Harian</button>
                        <button class="btn-secondary">Mingguan</button>
                        <button class="btn-secondary">Bulanan</button>
                    </div>
                </div>
                <div class="attendance-table-container">
                    <table class="attendance-table">
                        <thead>
                            <tr>
                                <th>No</th>
                                <th>Nama Siswa</th>
                                <th>NIS</th>
                                <th>Status</th>
                                <th>Waktu</th>
                                <th>Keterangan</th>
                            </tr>
                        </thead>
                        <tbody id="attendanceTableBody">
                            <!-- Attendance data will be loaded here -->
                        </tbody>
                    </table>
                </div>
                <div class="attendance-summary">
                    <div class="summary-card">
                        <h4>Ringkasan Kehadiran</h4>
                        <div class="summary-stats">
                            <div class="summary-item">
                                <span class="label">Total Siswa:</span>
                                <span class="value" id="totalStudentsSummary">36</span>
                            </div>
                            <div class="summary-item">
                                <span class="label">Hadir:</span>
                                <span class="value present" id="presentCountSummary">0</span>
                            </div>
                            <div class="summary-item">
                                <span class="label">Tidak Hadir:</span>
                                <span class="value absent" id="absentCountSummary">36</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Subject Attendance Tab -->
            <div id="subject-attendance" class="tab-content">
                <div class="tab-header">
                    <h2><i class="fas fa-book"></i> Absensi Mata Pelajaran</h2>
                    <div>
                        <button class="btn-primary" onclick="app.showAttendanceModal('subject')">
                            <i class="fas fa-plus"></i>
                            Input Absensi Mata Pelajaran
                        </button>
                    </div>
                </div>
                
                <div class="subject-attendance-section">
                    <h3>Ringkasan Absensi Mata Pelajaran</h3>
                    <div class="subject-attendance-controls">
                        <div class="group-control-item">
                            <label for="subjectAttendanceDate">Pilih Tanggal:</label>
                            <input type="date" id="subjectAttendanceDate">
                        </div>
                        <button class="btn-secondary" onclick="app.loadSubjectAttendance()">
                            <i class="fas fa-search"></i> Muat Data
                        </button>
                    </div>
                    
                    <div class="subject-attendance-grid" id="subjectAttendanceGrid">
                        <!-- Subject attendance cards will be loaded here -->
                    </div>
                </div>
                
                <div class="attendance-table-container">
                    <table class="attendance-table">
                        <thead>
                            <tr>
                                <th>No</th>
                                <th>Mata Pelajaran</th>
                                <th>Guru</th>
                                <th>Hadir</th>
                                <th>Sakit</th>
                                <th>Izin</th>
                                <th>Alpha</th>
                                <th>Aksi</th>
                            </tr>
                        </thead>
                        <tbody id="subjectAttendanceTableBody">
                            <!-- Subject attendance table will be loaded here -->
                        </tbody>
                    </table>
                </div>
            </div>
            
            <!-- Group Spinner Tab -->
            <div id="group-spinner" class="tab-content">
                <div class="tab-header">
                    <h2><i class="fas fa-random"></i> Pembagian Kelompok Acak</h2>
                </div>
                
                <div class="group-spinner-section">
                    <h3>Pengaturan Pembagian Kelompok</h3>
                    <div class="group-controls">
                        <div class="group-control-item">
                            <label for="groupCount">Jumlah Kelompok:</label>
                            <input type="number" id="groupCount" min="2" max="10" value="4">
                        </div>
                        <div class="group-control-item">
                            <label for="groupMethod">Metode Pembagian:</label>
                            <select id="groupMethod">
                                <option value="random">Acak Penuh</option>
                                <option value="balanced">Seimbang (Gender/Nilai)</option>
                                <option value="leader">Dengan Pemimpin Kelompok</option>
                            </select>
                        </div>
                        <div class="group-control-item">
                            <label for="includeAbsent">Siswa Tidak Hadir:</label>
                            <select id="includeAbsent">
                                <option value="include">Termasuk</option>
                                <option value="exclude" selected>Kecualikan</option>
                            </select>
                        </div>
                        <button class="btn-primary" onclick="app.generateGroups()">
                            <i class="fas fa-random"></i> Buat Kelompok
                        </button>
                        <button class="btn-secondary" onclick="app.regenerateGroups()">
                            <i class="fas fa-redo"></i> Acak Ulang
                        </button>
                    </div>
                    
                    <div class="spinner-container" id="groupSpinner">
                        <div class="spinner"></div>
                        <div class="spinner-text">Membuat kelompok acak...</div>
                    </div>
                    
                    <div class="groups-container" id="groupsContainer">
                        <!-- Groups will be loaded here -->
                    </div>
                    
                    <div class="group-actions">
                        <button class="export-btn" onclick="app.exportGroups()">
                            <i class="fas fa-print"></i> Cetak Kelompok
                        </button>
                        <button class="btn-secondary" onclick="app.saveGroups()">
                            <i class="fas fa-save"></i> Simpan Kelompok
                        </button>
                    </div>
                </div>
            </div>
            
            <!-- Classroom Layout Tab -->
            <div id="classroom" class="tab-content">
                <div class="tab-header">
                    <h2><i class="fas fa-chair"></i> Tata Letak Kelas XI-7 VALLORIX</h2>
                    <div>
                        <button class="btn-primary" onclick="app.randomizeSeats()">
                            <i class="fas fa-random"></i> Acak Tempat Duduk
                        </button>
                        <button class="btn-secondary" onclick="app.resetSeats()">
                            <i class="fas fa-undo"></i> Reset
                        </button>
                    </div>
                </div>
                
                <div class="classroom-layout">
                    <h3>Denah Kelas</h3>
                    <div class="classroom-controls">
                        <div class="group-control-item">
                            <label for="layoutType">Tipe Tata Letak:</label>
                            <select id="layoutType">
                                <option value="grid">Grid (6x6)</option>
                                <option value="u-shape">U-Shape</option>
                                <option value="groups">Kelompok</option>
                            </select>
                        </div>
                        <button class="btn-secondary" onclick="app.changeLayout()">
                            <i class="fas fa-sync"></i> Ubah Tata Letak
                        </button>
                    </div>
                    
                    <div class="classroom-grid" id="classroomGrid">
                        <!-- Classroom layout will be loaded here -->
                    </div>
                </div>
            </div>
            
            <!-- Duty Schedule Tab -->
            <div id="duty" class="tab-content">
                <div class="tab-header">
                    <h2><i class="fas fa-broom"></i> Jadwal Piket Kelas XI-7 VALLORIX</h2>
                    <div>
                        <button class="btn-primary" onclick="app.showDutyModal()">
                            <i class="fas fa-plus"></i> Tambah Jadwal
                        </button>
                        <button class="btn-secondary" onclick="app.generateDutySchedule()">
                            <i class="fas fa-random"></i> Buat Jadwal Otomatis
                        </button>
                    </div>
                </div>
                
                <div class="duty-schedule">
                    <h3>Jadwal Piket Minggu Ini</h3>
                    <div class="duty-controls">
                        <div class="group-control-item">
                            <label for="dutyWeek">Pilih Minggu:</label>
                            <input type="week" id="dutyWeek">
                        </div>
                        <button class="btn-secondary" onclick="app.loadDutySchedule()">
                            <i class="fas fa-search"></i> Muat Jadwal
                        </button>
                    </div>
                    
                    <div class="attendance-table-container">
                        <table class="duty-table">
                            <thead>
                                <tr>
                                    <th>Hari</th>
                                    <th>Petugas Piket</th>
                                    <th>Tugas</th>
                                    <th>Aksi</th>
                                </tr>
                            </thead>
                            <tbody id="dutyTableBody">
                                <!-- Duty schedule will be loaded here -->
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
            
            <!-- Schedule Tab -->
            <div id="schedule" class="tab-content">
                <div class="tab-header">
                    <h2>Jadwal Pelajaran XI-7 VALLORIX</h2>
                    <div class="schedule-actions">
                        <button class="btn-primary" onclick="app.showScheduleModal()">
                            <i class="fas fa-edit"></i>
                            Edit Jadwal
                        </button>
                        <button class="btn-secondary">
                            <i class="fas fa-print"></i>
                            Cetak Jadwal
                        </button>
                    </div>
                </div>
                <div class="weekly-schedule">
                    <div class="schedule-days">
                        <div class="day-header">Waktu</div>
                        <div class="day-header active">Senin</div>
                        <div class="day-header">Selasa</div>
                        <div class="day-header">Rabu</div>
                        <div class="day-header">Kamis</div>
                        <div class="day-header">Jumat</div>
                        <div class="day-header">Sabtu</div>
                    </div>
                    <div class="schedule-grid" id="scheduleGrid">
                        <!-- Schedule will be loaded here -->
                    </div>
                </div>
            </div>
            
            <!-- Students Tab -->
            <div id="students" class="tab-content">
                <div class="tab-header">
                    <h2>Data Siswa XI-7 VALLORIX</h2>
                    <div class="search-box">
                        <i class="fas fa-search"></i>
                        <input type="text" placeholder="Cari siswa..." id="studentSearch">
                    </div>
                </div>
                <div class="students-grid" id="studentsGrid">
                    <!-- Students will be loaded here -->
                </div>
            </div>
            
            <!-- Teachers Tab -->
            <div id="teachers" class="tab-content">
                <div class="tab-header">
                    <h2>Guru Pengajar XI-7 VALLORIX</h2>
                </div>
                <div class="teachers-grid" id="teachersGrid">
                    <!-- Teachers will be loaded here -->
                </div>
            </div>
            
            <!-- Assignments Tab -->
            <div id="assignments" class="tab-content">
                <div class="tab-header">
                    <h2>Tugas & Pekerjaan Rumah</h2>
                    <button class="btn-primary" onclick="app.showAssignmentModal()">
                        <i class="fas fa-plus"></i>
                        Tambah Tugas
                    </button>
                </div>
                <div class="assignments-container">
                    <div class="assignment-filters">
                        <button class="filter-btn active" data-filter="all">Semua</button>
                        <button class="filter-btn" data-filter="active">Aktif</button>
                        <button class="filter-btn" data-filter="urgent">Mendesak</button>
                        <button class="filter-btn" data-filter="completed">Selesai</button>
                    </div>
                    <div class="assignments-list-detailed" id="assignmentsList">
                        <!-- Assignments will be loaded here -->
                    </div>
                </div>
            </div>
        </main>
    </div>
    
    <!-- Attendance Modal -->
    <div id="attendanceModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 id="attendanceModalTitle">Input Absensi Harian</h3>
                <button class="close-btn" onclick="app.closeModal('attendanceModal')">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body">
                <form id="attendanceForm">
                    <input type="hidden" id="attendanceType" value="daily">
                    <div class="form-group">
                        <label for="modalDate">Tanggal</label>
                        <input type="date" id="modalDate" required>
                    </div>
                    <div class="form-group" id="subjectField" style="display: none;">
                        <label for="modalSubject">Mata Pelajaran</label>
                        <select id="modalSubject">
                            <option value="">Pilih Mapel</option>
                            <option value="matematika">Matematika</option>
                            <option value="fisika">Fisika</option>
                            <option value="kimia">Kimia</option>
                            <option value="biologi">Biologi</option>
                            <option value="bindo">Bahasa Indonesia</option>
                            <option value="bing">Bahasa Inggris</option>
                            <option value="tik">TIK Lanjut</option>
                            <option value="sosiologi">Sosiologi Lanjut</option>
                            <option value="ekonomi">Ekonomi Lanjut</option>
                            <option value="bahasa_jepang">Bahasa Jepang Lanjut</option>
                        </select>
                    </div>
                    <div class="students-attendance-list">
                        <h4>Daftar Siswa</h4>
                        <div id="attendanceStudentsList">
                            <!-- Students list for attendance -->
                        </div>
                    </div>
                    <button type="submit" class="btn-primary full-width">
                        <i class="fas fa-save"></i>
                        Simpan Absensi
                    </button>
                </form>
            </div>
        </div>
    </div>
    
    <!-- Assignment Modal -->
    <div id="assignmentModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 id="assignmentModalTitle">Tambah Tugas Baru</h3>
                <button class="close-btn" onclick="app.closeModal('assignmentModal')">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body">
                <form id="assignmentForm">
                    <input type="hidden" id="assignmentId">
                    <div class="form-group">
                        <label for="assignmentSubject">Mata Pelajaran</label>
                        <select id="assignmentSubject" required>
                            <option value="">Pilih Mapel</option>
                            <option value="matematika">Matematika</option>
                            <option value="fisika">Fisika</option>
                            <option value="kimia">Kimia</option>
                            <option value="biologi">Biologi</option>
                            <option value="bindo">Bahasa Indonesia</option>
                            <option value="bing">Bahasa Inggris</option>
                            <option value="tik">TIK Lanjut</option>
                            <option value="sosiologi">Sosiologi Lanjut</option>
                            <option value="ekonomi">Ekonomi Lanjut</option>
                            <option value="bahasa_jepang">Bahasa Jepang Lanjut</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="assignmentTitle">Judul Tugas</label>
                        <input type="text" id="assignmentTitle" placeholder="Masukkan judul tugas" required>
                    </div>
                    <div class="form-group">
                        <label for="assignmentDescription">Deskripsi</label>
                        <textarea id="assignmentDescription" rows="3" placeholder="Masukkan deskripsi tugas"></textarea>
                    </div>
                    <div class="form-group">
                        <label for="assignmentDeadline">Deadline</label>
                        <input type="date" id="assignmentDeadline" required>
                    </div>
                    <div class="form-group">
                        <label for="assignmentType">Jenis Tugas</label>
                        <select id="assignmentType" required>
                            <option value="pr">Pekerjaan Rumah</option>
                            <option value="ulangan">Ulangan</option>
                            <option value="proyek">Proyek</option>
                            <option value="lainnya">Lainnya</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="assignmentStatus">Status</label>
                        <select id="assignmentStatus" required>
                            <option value="active">Aktif</option>
                            <option value="urgent">Mendesak</option>
                            <option value="completed">Selesai</option>
                        </select>
                    </div>
                    <button type="submit" class="btn-primary full-width">
                        <i class="fas fa-save"></i>
                        Simpan Tugas
                    </button>
                </form>
            </div>
        </div>
    </div>

    <!-- Announcement Modal -->
    <div id="announcementModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Edit Pengumuman</h3>
                <button class="close-btn" onclick="app.closeModal('announcementModal')">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body">
                <form id="announcementForm">
                    <div class="form-group">
                        <label for="announcementTextInput">Isi Pengumuman</label>
                        <textarea id="announcementTextInput" rows="4" placeholder="Masukkan pengumuman baru"></textarea>
                    </div>
                    <button type="submit" class="btn-primary full-width">
                        <i class="fas fa-save"></i>
                        Simpan Pengumuman
                    </button>
                </form>
            </div>
        </div>
    </div>

    <!-- Schedule Edit Modal -->
    <div id="scheduleModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 id="scheduleModalTitle">Edit Jadwal Pelajaran</h3>
                <button class="close-btn" onclick="app.closeModal('scheduleModal')">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body">
                <form id="scheduleForm">
                    <input type="hidden" id="scheduleId">
                    <div class="form-group">
                        <label for="scheduleDay">Hari</label>
                        <select id="scheduleDay" required>
                            <option value="">Pilih Hari</option>
                            <option value="Senin">Senin</option>
                            <option value="Selasa">Selasa</option>
                            <option value="Rabu">Rabu</option>
                            <option value="Kamis">Kamis</option>
                            <option value="Jumat">Jumat</option>
                            <option value="Sabtu">Sabtu</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="scheduleTime">Waktu</label>
                        <select id="scheduleTime" required>
                            <option value="">Pilih Waktu</option>
                            <option value="07:00-08:30">07:00-08:30</option>
                            <option value="08:30-10:00">08:30-10:00</option>
                            <option value="10:00-11:30">10:00-11:30</option>
                            <option value="11:30-13:00">11:30-13:00</option>
                            <option value="13:00-14:30">13:00-14:30</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="scheduleSubject">Mata Pelajaran</label>
                        <select id="scheduleSubject" required>
                            <option value="">Pilih Mapel</option>
                            <option value="Matematika">Matematika</option>
                            <option value="Fisika">Fisika</option>
                            <option value="Kimia">Kimia</option>
                            <option value="Biologi">Biologi</option>
                            <option value="Bahasa Indonesia">Bahasa Indonesia</option>
                            <option value="Bahasa Inggris">Bahasa Inggris</option>
                            <option value="TIK Lanjut">TIK Lanjut</option>
                            <option value="Sosiologi Lanjut">Sosiologi Lanjut</option>
                            <option value="Ekonomi Lanjut">Ekonomi Lanjut</option>
                            <option value="Bahasa Jepang Lanjut">Bahasa Jepang Lanjut</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="scheduleTeacher">Guru</label>
                        <select id="scheduleTeacher" required>
                            <option value="">Pilih Guru</option>
                            <option value="Bu Sari, S.Pd">Bu Sari, S.Pd</option>
                            <option value="Pak Budi, M.Pd">Pak Budi, M.Pd</option>
                            <option value="Bu Dewi, S.Pd">Bu Dewi, S.Pd</option>
                            <option value="Pak Andi, S.Pd">Pak Andi, S.Pd</option>
                            <option value="Bu Rini, M.Pd">Bu Rini, M.Pd</option>
                            <option value="Bu Maya, S.Pd">Bu Maya, S.Pd</option>
                            <option value="Pak Joko, S.Kom">Pak Joko, S.Kom</option>
                            <option value="Bu Sinta, S.Sos">Bu Sinta, S.Sos</option>
                            <option value="Pak Rudi, S.E">Pak Rudi, S.E</option>
                            <option value="Bu Yuki, S.Pd">Bu Yuki, S.Pd</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="scheduleRoom">Ruangan</label>
                        <input type="text" id="scheduleRoom" placeholder="Masukkan ruangan" required>
                    </div>
                    <div class="form-group">
                        <label for="teacherStatus">Status Guru</label>
                        <select id="teacherStatus">
                            <option value="present">Hadir</option>
                            <option value="absent">Tidak Hadir</option>
                        </select>
                    </div>
                    <button type="submit" class="btn-primary full-width">
                        <i class="fas fa-save"></i>
                        Simpan Jadwal
                    </button>
                </form>
            </div>
        </div>
    </div>

    <!-- Duty Modal -->
    <div id="dutyModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 id="dutyModalTitle">Tambah Jadwal Piket</h3>
                <button class="close-btn" onclick="app.closeModal('dutyModal')">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body">
                <form id="dutyForm">
                    <input type="hidden" id="dutyId">
                    <div class="form-group">
                        <label for="dutyDay">Hari</label>
                        <select id="dutyDay" required>
                            <option value="">Pilih Hari</option>
                            <option value="Senin">Senin</option>
                            <option value="Selasa">Selasa</option>
                            <option value="Rabu">Rabu</option>
                            <option value="Kamis">Kamis</option>
                            <option value="Jumat">Jumat</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="dutyStudents">Petugas Piket</label>
                        <select id="dutyStudents" multiple required>
                            <!-- Students will be loaded here -->
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="dutyTasks">Tugas</label>
                        <textarea id="dutyTasks" rows="3" placeholder="Masukkan tugas piket"></textarea>
                    </div>
                    <button type="submit" class="btn-primary full-width">
                        <i class="fas fa-save"></i>
                        Simpan Jadwal Piket
                    </button>
                </form>
            </div>
        </div>
    </div>

    <script>
        class ClassWebsite {
            constructor() {
                this.currentClass = 'XI-7 VALLORIX';
                this.students = this.loadStudents();
                this.teachers = this.loadTeachers();
                this.schedule = this.loadSchedule();
                this.attendance = this.loadAttendance();
                this.assignments = this.loadAssignments();
                this.announcement = this.loadAnnouncement();
                this.groups = this.loadGroups();
                this.activities = this.loadActivities();
                this.classroom = this.loadClassroom();
                this.duty = this.loadDuty();
                this.structure = this.loadStructure();
                this.searchPages = this.loadSearchPages();
                this.init();
            }

            init() {
                this.bindEvents();
                this.loadHomePage();
                this.loadAttendanceTab();
                this.loadSubjectAttendanceTab();
                this.loadGroupSpinnerTab();
                this.loadClassroomTab();
                this.loadDutyTab();
                this.loadScheduleTab();
                this.loadStudentsTab();
                this.loadTeachersTab();
                this.loadAssignmentsTab();
                this.updateAnnouncement();
                
                // Initialize theme
                this.initTheme();
            }

            // Initialize theme
            initTheme() {
                const savedTheme = localStorage.getItem('theme');
                const themeToggle = document.getElementById('themeToggle');
                
                if (savedTheme === 'dark') {
                    document.body.classList.add('dark-mode');
                    themeToggle.innerHTML = '<i class="fas fa-sun"></i>';
                } else {
                    document.body.classList.remove('dark-mode');
                    themeToggle.innerHTML = '<i class="fas fa-moon"></i>';
                }
                
                // Add event listener for theme toggle
                themeToggle.addEventListener('click', () => {
                    this.toggleTheme();
                });
            }

            // Toggle theme
            toggleTheme() {
                const themeToggle = document.getElementById('themeToggle');
                
                if (document.body.classList.contains('dark-mode')) {
                    document.body.classList.remove('dark-mode');
                    themeToggle.innerHTML = '<i class="fas fa-moon"></i>';
                    localStorage.setItem('theme', 'light');
                } else {
                    document.body.classList.add('dark-mode');
                    themeToggle.innerHTML = '<i class="fas fa-sun"></i>';
                    localStorage.setItem('theme', 'dark');
                }
            }

            // Load search pages data
            loadSearchPages() {
                return [
                    { name: 'Halaman Utama', tab: 'home', icon: 'home', keywords: ['beranda', 'utama', 'dashboard'] },
                    { name: 'Absensi Harian', tab: 'attendance', icon: 'clipboard-check', keywords: ['absensi', 'kehadiran', 'hadir', 'absen'] },
                    { name: 'Absensi Mata Pelajaran', tab: 'subject-attendance', icon: 'book', keywords: ['absensi mapel', 'mata pelajaran', 'mapel'] },
                    { name: 'Pembagian Kelompok', tab: 'group-spinner', icon: 'random', keywords: ['kelompok', 'pembagian', 'acak'] },
                    { name: 'Tata Letak Kelas', tab: 'classroom', icon: 'chair', keywords: ['tata letak', 'kelas', 'tempat duduk'] },
                    { name: 'Jadwal Piket', tab: 'duty', icon: 'broom', keywords: ['piket', 'kebersihan', 'tugas piket'] },
                    { name: 'Jadwal Pelajaran', tab: 'schedule', icon: 'calendar-alt', keywords: ['jadwal', 'pelajaran', 'mata pelajaran'] },
                    { name: 'Data Siswa', tab: 'students', icon: 'user-graduate', keywords: ['siswa', 'data siswa', 'murid'] },
                    { name: 'Data Guru', tab: 'teachers', icon: 'chalkboard-teacher', keywords: ['guru', 'pengajar', 'data guru'] },
                    { name: 'Tugas', tab: 'assignments', icon: 'tasks', keywords: ['tugas', 'pekerjaan rumah', 'pr', 'ulangan'] }
                ];
            }

            bindEvents() {
                // Navigation
                document.querySelectorAll('.nav-item').forEach(item => {
                    item.addEventListener('click', (e) => {
                        e.preventDefault();
                        this.switchTab(item.dataset.tab);
                    });
                });

                // Attendance form
                document.getElementById('attendanceForm').addEventListener('submit', (e) => {
                    e.preventDefault();
                    this.submitAttendance();
                });

                // Assignment form
                document.getElementById('assignmentForm').addEventListener('submit', (e) => {
                    e.preventDefault();
                    this.submitAssignment();
                });

                // Announcement form
                document.getElementById('announcementForm').addEventListener('submit', (e) => {
                    e.preventDefault();
                    this.saveAnnouncement();
                });

                // Schedule form
                document.getElementById('scheduleForm').addEventListener('submit', (e) => {
                    e.preventDefault();
                    this.submitSchedule();
                });

                // Duty form
                document.getElementById('dutyForm').addEventListener('submit', (e) => {
                    e.preventDefault();
                    this.submitDuty();
                });

                // Date change for attendance
                document.getElementById('attendanceDate').addEventListener('change', (e) => {
                    this.loadAttendanceData(e.target.value);
                });

                // Date change for subject attendance
                document.getElementById('subjectAttendanceDate').addEventListener('change', (e) => {
                    this.loadSubjectAttendance();
                });

                // Student search
                document.getElementById('studentSearch').addEventListener('input', (e) => {
                    this.filterStudents(e.target.value);
                });

                // Header search
                document.getElementById('headerSearch').addEventListener('input', (e) => {
                    this.searchPagesAndFeatures(e.target.value);
                });

                // Assignment filters
                document.querySelectorAll('.filter-btn').forEach(btn => {
                    btn.addEventListener('click', (e) => {
                        document.querySelectorAll('.filter-btn').forEach(b => b.classList.remove('active'));
                        e.target.classList.add('active');
                        this.filterAssignments(e.target.dataset.filter);
                    });
                });

                // Update attendance students when date or subject changes
                document.getElementById('modalDate').addEventListener('change', () => {
                    this.loadAttendanceStudents();
                });
                document.getElementById('modalSubject').addEventListener('change', () => {
                    this.loadAttendanceStudents();
                });

                // Set default week for duty schedule
                const today = new Date();
                const currentWeek = this.getWeekNumber(today);
                document.getElementById('dutyWeek').value = `${today.getFullYear()}-W${currentWeek.toString().padStart(2, '0')}`;
            }

            // Search pages and features
            searchPagesAndFeatures(query) {
                const suggestionsContainer = document.getElementById('searchSuggestions');
                
                if (query.length < 2) {
                    suggestionsContainer.classList.remove('active');
                    return;
                }
                
                const lowerQuery = query.toLowerCase();
                const matchedPages = this.searchPages.filter(page => 
                    page.name.toLowerCase().includes(lowerQuery) || 
                    page.keywords.some(keyword => keyword.includes(lowerQuery))
                );
                
                if (matchedPages.length > 0) {
                    suggestionsContainer.innerHTML = matchedPages.map(page => `
                        <div class="suggestion-item" onclick="app.switchTab('${page.tab}')">
                            <i class="fas fa-${page.icon}"></i>
                            ${page.name}
                        </div>
                    `).join('');
                    
                    suggestionsContainer.classList.add('active');
                } else {
                    suggestionsContainer.innerHTML = `
                        <div class="suggestion-item">
                            <i class="fas fa-search"></i>
                            Tidak ditemukan. Coba kata kunci lain.
                        </div>
                    `;
                    suggestionsContainer.classList.add('active');
                }
            }

            loadStudents() {
                return [
                    { id: 1, name: 'Ahmad Rizki', nis: '2024001', email: 'ahmad1@email.com', phone: '081234567890', gender: 'L' },
                    { id: 2, name: 'Sari Dewi', nis: '2024002', email: 'sari2@email.com', phone: '081234567891', gender: 'P' },
                    { id: 3, name: 'Budi Santoso', nis: '2024003', email: 'budi3@email.com', phone: '081234567892', gender: 'L' },
                    { id: 4, name: 'Maya Sari', nis: '2024004', email: 'maya4@email.com', phone: '081234567893', gender: 'P' },
                    { id: 5, name: 'Rizki Pratama', nis: '2024005', email: 'rizki5@email.com', phone: '081234567894', gender: 'L' },
                    { id: 6, name: 'Dewi Lestari', nis: '2024006', email: 'dewi6@email.com', phone: '081234567895', gender: 'P' },
                    { id: 7, name: 'Andi Wijaya', nis: '2024007', email: 'andi7@email.com', phone: '081234567896', gender: 'L' },
                    { id: 8, name: 'Siti Nurhaliza', nis: '2024008', email: 'siti8@email.com', phone: '081234567897', gender: 'P' },
                    { id: 9, name: 'Eko Prasetya', nis: '2024009', email: 'eko9@email.com', phone: '081234567898', gender: 'L' },
                    { id: 10, name: 'Lina Kusuma', nis: '2024010', email: 'lina10@email.com', phone: '081234567899', gender: 'P' },
                    { id: 11, name: 'Fajar Nugroho', nis: '2024011', email: 'fajar11@email.com', phone: '081234567800', gender: 'L' },
                    { id: 12, name: 'Intan Permata', nis: '2024012', email: 'intan12@email.com', phone: '081234567801', gender: 'P' },
                    { id: 13, name: 'Guntur Prakasa', nis: '2024013', email: 'guntur13@email.com', phone: '081234567802', gender: 'L' },
                    { id: 14, name: 'Heni Susanti', nis: '2024014', email: 'heni14@email.com', phone: '081234567803', gender: 'P' },
                    { id: 15, name: 'Irfan Maulana', nis: '2024015', email: 'irfan15@email.com', phone: '081234567804', gender: 'L' },
                    { id: 16, name: 'Jihan Aulia', nis: '2024016', email: 'jihan16@email.com', phone: '081234567805', gender: 'P' },
                    { id: 17, name: 'Krisna Adi', nis: '2024017', email: 'krisna17@email.com', phone: '081234567806', gender: 'L' },
                    { id: 18, name: 'Lintang Sari', nis: '2024018', email: 'lintang18@email.com', phone: '081234567807', gender: 'P' },
                    { id: 19, name: 'Maulana Yusuf', nis: '2024019', email: 'maulana19@email.com', phone: '081234567808', gender: 'L' },
                    { id: 20, name: 'Nadia Putri', nis: '2024020', email: 'nadia20@email.com', phone: '081234567809', gender: 'P' },
                    { id: 21, name: 'Oka Pratama', nis: '2024021', email: 'oka21@email.com', phone: '081234567810', gender: 'L' },
                    { id: 22, name: 'Putri Lestari', nis: '2024022', email: 'putri22@email.com', phone: '081234567811', gender: 'P' },
                    { id: 23, name: 'Rama Kusuma', nis: '2024023', email: 'rama23@email.com', phone: '081234567812', gender: 'L' },
                    { id: 24, name: 'Siska Anggraini', nis: '2024024', email: 'siska24@email.com', phone: '081234567813', gender: 'P' },
                    { id: 25, name: 'Taufik Hidayat', nis: '2024025', email: 'taufik25@email.com', phone: '081234567814', gender: 'L' },
                    { id: 26, name: 'Umi Kalsum', nis: '2024026', email: 'umi26@email.com', phone: '081234567815', gender: 'P' },
                    { id: 27, name: 'Vicky Prasetya', nis: '2024027', email: 'vicky27@email.com', phone: '081234567816', gender: 'L' },
                    { id: 28, name: 'Wulan Sari', nis: '2024028', email: 'wulan28@email.com', phone: '081234567817', gender: 'P' },
                    { id: 29, name: 'Xavier Adi', nis: '2024029', email: 'xavier29@email.com', phone: '081234567818', gender: 'L' },
                    { id: 30, name: 'Yuni Astuti', nis: '2024030', email: 'yuni30@email.com', phone: '081234567819', gender: 'P' },
                    { id: 31, name: 'Zaki Prasetyo', nis: '2024031', email: 'zaki31@email.com', phone: '081234567820', gender: 'L' },
                    { id: 32, name: 'Anisa Khoirunnisa', nis: '2024032', email: 'anisa32@email.com', phone: '081234567821', gender: 'P' },
                    { id: 33, name: 'Bayu Setiawan', nis: '2024033', email: 'bayu33@email.com', phone: '081234567822', gender: 'L' },
                    { id: 34, name: 'Citra Dewi', nis: '2024034', email: 'citra34@email.com', phone: '081234567823', gender: 'P' },
                    { id: 35, name: 'Dian Prasetya', nis: '2024035', email: 'dian35@email.com', phone: '081234567824', gender: 'L' },
                    { id: 36, name: 'Eva Lestari', nis: '2024036', email: 'eva36@email.com', phone: '081234567825', gender: 'P' }
                ];
            }

            loadTeachers() {
                return [
                    { 
                        id: 1, 
                        name: 'Bu Sari, S.Pd', 
                        subject: 'Matematika', 
                        qualification: 'S1 Pendidikan Matematika',
                        email: 'sari@sekolah.sch.id',
                        phone: '081234567800'
                    },
                    { 
                        id: 2, 
                        name: 'Pak Budi, M.Pd', 
                        subject: 'Fisika', 
                        qualification: 'S2 Pendidikan Fisika',
                        email: 'budi@sekolah.sch.id',
                        phone: '081234567801'
                    },
                    { 
                        id: 3, 
                        name: 'Bu Dewi, S.Pd', 
                        subject: 'Kimia', 
                        qualification: 'S1 Pendidikan Kimia',
                        email: 'dewi@sekolah.sch.id',
                        phone: '081234567802'
                    },
                    { 
                        id: 4, 
                        name: 'Pak Andi, S.Pd', 
                        subject: 'Biologi', 
                        qualification: 'S1 Pendidikan Biologi',
                        email: 'andi@sekolah.sch.id',
                        phone: '081234567803'
                    },
                    { 
                        id: 5, 
                        name: 'Bu Rini, M.Pd', 
                        subject: 'Bahasa Indonesia', 
                        qualification: 'S2 Pendidikan Bahasa Indonesia',
                        email: 'rini@sekolah.sch.id',
                        phone: '081234567804'
                    },
                    { 
                        id: 6, 
                        name: 'Bu Maya, S.Pd', 
                        subject: 'Bahasa Inggris', 
                        qualification: 'S1 Pendidikan Bahasa Inggris',
                        email: 'maya@sekolah.sch.id',
                        phone: '081234567805'
                    },
                    { 
                        id: 7, 
                        name: 'Pak Joko, S.Kom', 
                        subject: 'TIK Lanjut', 
                        qualification: 'S1 Teknik Informatika',
                        email: 'joko@sekolah.sch.id',
                        phone: '081234567806'
                    },
                    { 
                        id: 8, 
                        name: 'Bu Sinta, S.Sos', 
                        subject: 'Sosiologi Lanjut', 
                        qualification: 'S1 Sosiologi',
                        email: 'sinta@sekolah.sch.id',
                        phone: '081234567807'
                    },
                    { 
                        id: 9, 
                        name: 'Pak Rudi, S.E', 
                        subject: 'Ekonomi Lanjut', 
                        qualification: 'S1 Ekonomi',
                        email: 'rudi@sekolah.sch.id',
                        phone: '081234567808'
                    },
                    { 
                        id: 10, 
                        name: 'Bu Yuki, S.Pd', 
                        subject: 'Bahasa Jepang Lanjut', 
                        qualification: 'S1 Pendidikan Bahasa Jepang',
                        email: 'yuki@sekolah.sch.id',
                        phone: '081234567809'
                    }
                ];
            }

            loadSchedule() {
                const saved = localStorage.getItem('scheduleData');
                if (saved) {
                    return JSON.parse(saved);
                } else {
                    const defaultSchedule = {
                        'Senin': [
                            { time: '07:00-08:30', subject: 'Matematika', teacher: 'Bu Sari, S.Pd', room: 'Ruang 201', teacherStatus: 'present' },
                            { time: '08:30-10:00', subject: 'Fisika', teacher: 'Pak Budi, M.Pd', room: 'Lab Fisika', teacherStatus: 'present' },
                            { time: '10:00-11:30', subject: 'Kimia', teacher: 'Bu Dewi, S.Pd', room: 'Lab Kimia', teacherStatus: 'present' },
                            { time: '13:00-14:30', subject: 'TIK Lanjut', teacher: 'Pak Joko, S.Kom', room: 'Lab Komputer', teacherStatus: 'present' }
                        ],
                        'Selasa': [
                            { time: '07:00-08:30', subject: 'Biologi', teacher: 'Pak Andi, S.Pd', room: 'Lab Biologi', teacherStatus: 'present' },
                            { time: '08:30-10:00', subject: 'Bahasa Indonesia', teacher: 'Bu Rini, M.Pd', room: 'Ruang 201', teacherStatus: 'present' },
                            { time: '10:00-11:30', subject: 'Sosiologi Lanjut', teacher: 'Bu Sinta, S.Sos', room: 'Ruang 202', teacherStatus: 'present' }
                        ],
                        'Rabu': [
                            { time: '07:00-08:30', subject: 'Matematika', teacher: 'Bu Sari, S.Pd', room: 'Ruang 201', teacherStatus: 'present' },
                            { time: '08:30-10:00', subject: 'Fisika', teacher: 'Pak Budi, M.Pd', room: 'Lab Fisika', teacherStatus: 'present' },
                            { time: '10:00-11:30', subject: 'Bahasa Inggris', teacher: 'Bu Maya, S.Pd', room: 'Ruang 203', teacherStatus: 'present' }
                        ],
                        'Kamis': [
                            { time: '07:00-08:30', subject: 'Kimia', teacher: 'Bu Dewi, S.Pd', room: 'Lab Kimia', teacherStatus: 'present' },
                            { time: '08:30-10:00', subject: 'Biologi', teacher: 'Pak Andi, S.Pd', room: 'Lab Biologi', teacherStatus: 'present' },
                            { time: '10:00-11:30', subject: 'Ekonomi Lanjut', teacher: 'Pak Rudi, S.E', room: 'Ruang 204', teacherStatus: 'present' }
                        ],
                        'Jumat': [
                            { time: '07:00-08:30', subject: 'Bahasa Indonesia', teacher: 'Bu Rini, M.Pd', room: 'Ruang 201', teacherStatus: 'present' },
                            { time: '08:30-10:00', subject: 'Bahasa Jepang Lanjut', teacher: 'Bu Yuki, S.Pd', room: 'Ruang 205', teacherStatus: 'present' }
                        ],
                        'Sabtu': [
                            { time: '07:00-09:00', subject: 'Ekstrakurikuler', teacher: 'Various', room: 'Lapangan', teacherStatus: 'present' }
                        ]
                    };
                    localStorage.setItem('scheduleData', JSON.stringify(defaultSchedule));
                    return defaultSchedule;
                }
            }

            loadAttendance() {
                const saved = localStorage.getItem('attendanceData');
                if (saved) {
                    return JSON.parse(saved);
                } else {
                    // Create sample data for demonstration
                    const sampleData = {
                        records: [
                            // Sample records for demonstration
                            {
                                id: 1,
                                date: new Date().toISOString().split('T')[0],
                                type: 'daily',
                                studentId: 1,
                                studentName: 'Ahmad Rizki',
                                nis: '2024001',
                                status: 'present',
                                time: '07:15',
                                timestamp: new Date().toISOString()
                            },
                            {
                                id: 2,
                                date: new Date().toISOString().split('T')[0],
                                type: 'daily',
                                studentId: 2,
                                studentName: 'Sari Dewi',
                                nis: '2024002',
                                status: 'absent',
                                time: '07:15',
                                timestamp: new Date().toISOString()
                            },
                            {
                                id: 3,
                                date: new Date().toISOString().split('T')[0],
                                type: 'subject',
                                subject: 'matematika',
                                studentId: 3,
                                studentName: 'Budi Santoso',
                                nis: '2024003',
                                status: 'sick',
                                time: '08:45',
                                timestamp: new Date().toISOString()
                            },
                            {
                                id: 4,
                                date: new Date().toISOString().split('T')[0],
                                type: 'subject',
                                subject: 'kimia',
                                studentId: 4,
                                studentName: 'Maya Sari',
                                nis: '2024004',
                                status: 'permission',
                                time: '10:15',
                                timestamp: new Date().toISOString()
                            },
                            // Add more sample records for different dates
                            {
                                id: 5,
                                date: new Date(Date.now() - 86400000).toISOString().split('T')[0], // Yesterday
                                type: 'daily',
                                studentId: 2,
                                studentName: 'Sari Dewi',
                                nis: '2024002',
                                status: 'absent',
                                time: '07:15',
                                timestamp: new Date(Date.now() - 86400000).toISOString()
                            },
                            {
                                id: 6,
                                date: new Date(Date.now() - 86400000).toISOString().split('T')[0], // Yesterday
                                type: 'subject',
                                subject: 'fisika',
                                studentId: 3,
                                studentName: 'Budi Santoso',
                                nis: '2024003',
                                status: 'absent',
                                time: '08:45',
                                timestamp: new Date(Date.now() - 86400000).toISOString()
                            }
                        ]
                    };
                    localStorage.setItem('attendanceData', JSON.stringify(sampleData));
                    return sampleData;
                }
            }

            loadAssignments() {
                const saved = localStorage.getItem('assignmentData');
                return saved ? JSON.parse(saved) : { assignments: [] };
            }

            loadAnnouncement() {
                const saved = localStorage.getItem('announcementData');
                return saved ? JSON.parse(saved) : { text: "Persiapan Ujian Tengah Semester akan dimulai minggu depan. Mari persiapkan dengan baik!" };
            }

            loadGroups() {
                const saved = localStorage.getItem('groupData');
                return saved ? JSON.parse(saved) : { groups: [] };
            }

            loadActivities() {
                const saved = localStorage.getItem('activityData');
                if (saved) {
                    return JSON.parse(saved);
                } else {
                    // Create sample activities
                    const sampleActivities = [
                        {
                            id: 1,
                            type: 'attendance',
                            title: 'Absensi pagi telah diinput',
                            description: '28 siswa hadir',
                            time: new Date().toISOString(),
                            icon: 'clipboard-check'
                        },
                        {
                            id: 2,
                            type: 'assignment',
                            title: 'Tugas Matematika dikumpulkan',
                            description: '25 siswa mengumpulkan',
                            time: new Date(Date.now() - 86400000).toISOString(),
                            icon: 'tasks'
                        },
                        {
                            id: 3,
                            type: 'announcement',
                            title: 'Pengumuman baru dari Wali Kelas',
                            description: 'Persiapan UTS',
                            time: new Date(Date.now() - 172800000).toISOString(),
                            icon: 'comment'
                        },
                        {
                            id: 4,
                            type: 'assignment',
                            title: 'Tugas Fisika ditambahkan',
                            description: 'Deadline 3 hari lagi',
                            time: new Date(Date.now() - 259200000).toISOString(),
                            icon: 'tasks'
                        }
                    ];
                    localStorage.setItem('activityData', JSON.stringify(sampleActivities));
                    return sampleActivities;
                }
            }

            // Load classroom data
            loadClassroom() {
                const saved = localStorage.getItem('classroomData');
                if (saved) {
                    return JSON.parse(saved);
                } else {
                    // Create default classroom layout
                    const defaultClassroom = {
                        layout: 'grid',
                        seats: []
                    };
                    
                    // Initialize with empty seats
                    for (let i = 1; i <= 36; i++) {
                        defaultClassroom.seats.push({
                            deskNumber: i,
                            studentId: null,
                            studentName: null
                        });
                    }
                    
                    localStorage.setItem('classroomData', JSON.stringify(defaultClassroom));
                    return defaultClassroom;
                }
            }

            // Load duty schedule
            loadDuty() {
                const saved = localStorage.getItem('dutyData');
                if (saved) {
                    return JSON.parse(saved);
                } else {
                    // Create sample duty schedule
                    const sampleDuty = {
                        schedule: [
                            {
                                id: 1,
                                day: 'Senin',
                                students: [1, 2, 3],
                                tasks: 'Menyapu lantai, membersihkan papan tulis'
                            },
                            {
                                id: 2,
                                day: 'Selasa',
                                students: [4, 5, 6],
                                tasks: 'Mengepel lantai, merapikan buku'
                            },
                            {
                                id: 3,
                                day: 'Rabu',
                                students: [7, 8, 9],
                                tasks: 'Membersihkan jendela, menyiram tanaman'
                            },
                            {
                                id: 4,
                                day: 'Kamis',
                                students: [10, 11, 12],
                                tasks: 'Menyapu halaman, merapikan meja guru'
                            },
                            {
                                id: 5,
                                day: 'Jumat',
                                students: [13, 14, 15],
                                tasks: 'Membersihkan rak buku, menata kursi'
                            }
                        ]
                    };
                    localStorage.setItem('dutyData', JSON.stringify(sampleDuty));
                    return sampleDuty;
                }
            }

            // Load class structure
            loadStructure() {
                const saved = localStorage.getItem('structureData');
                if (saved) {
                    return JSON.parse(saved);
                } else {
                    // Create sample class structure
                    const sampleStructure = {
                        motto: "Bersatu dalam Perbedaan, Berprestasi dalam Kebersamaan",
                        members: [
                            { id: 1, name: 'Bu Sari, S.Pd', role: 'Wali Kelas', contact: 'sari@sekolah.sch.id' },
                            { id: 2, name: 'Ahmad Rizki', role: 'Ketua Kelas', contact: 'ahmad1@email.com' },
                            { id: 3, name: 'Sari Dewi', role: 'Wakil Ketua', contact: 'sari2@email.com' },
                            { id: 4, name: 'Budi Santoso', role: 'Sekretaris 1', contact: 'budi3@email.com' },
                            { id: 5, name: 'Maya Sari', role: 'Sekretaris 2', contact: 'maya4@email.com' },
                            { id: 6, name: 'Rizki Pratama', role: 'Bendahara 1', contact: 'rizki5@email.com' },
                            { id: 7, name: 'Dewi Lestari', role: 'Bendahara 2', contact: 'dewi6@email.com' }
                        ],
                        gallery: [
                            { id: 1, title: 'Foto Kelas' },
                            { id: 2, title: 'Kegiatan Belajar' },
                            { id: 3, title: 'Ekstrakurikuler' },
                            { id: 4, title: 'Perlombaan' },
                            { id: 5, title: 'Karya Siswa' },
                            { id: 6, title: 'Kegiatan Sosial' }
                        ]
                    };
                    localStorage.setItem('structureData', JSON.stringify(sampleStructure));
                    return sampleStructure;
                }
            }

            saveSchedule() {
                localStorage.setItem('scheduleData', JSON.stringify(this.schedule));
            }

            saveAttendance() {
                localStorage.setItem('attendanceData', JSON.stringify(this.attendance));
            }

            saveAssignments() {
                localStorage.setItem('assignmentData', JSON.stringify(this.assignments));
            }

            saveAnnouncementData() {
                localStorage.setItem('announcementData', JSON.stringify(this.announcement));
            }

            saveGroups() {
                localStorage.setItem('groupData', JSON.stringify(this.groups));
            }

            saveActivities() {
                localStorage.setItem('activityData', JSON.stringify(this.activities));
            }

            // Save classroom data
            saveClassroom() {
                localStorage.setItem('classroomData', JSON.stringify(this.classroom));
            }

            // Save duty schedule
            saveDuty() {
                localStorage.setItem('dutyData', JSON.stringify(this.duty));
            }

            // Save class structure
            saveStructure() {
                localStorage.setItem('structureData', JSON.stringify(this.structure));
            }

            switchTab(tabName) {
                // Hide all tab contents
                document.querySelectorAll('.tab-content').forEach(tab => {
                    tab.classList.remove('active');
                });
                // Remove active class from all nav items
                document.querySelectorAll('.nav-item').forEach(item => {
                    item.classList.remove('active');
                });
                // Show selected tab
                document.getElementById(tabName).classList.add('active');
                // Activate corresponding nav item
                document.querySelector(`[data-tab="${tabName}"]`).classList.add('active');
                
                // Hide search suggestions
                document.getElementById('searchSuggestions').classList.remove('active');
                
                // Load specific tab data if needed
                if (tabName === 'group-spinner') {
                    this.loadGroupSpinnerTab();
                } else if (tabName === 'classroom') {
                    this.loadClassroomTab();
                } else if (tabName === 'duty') {
                    this.loadDutyTab();
                } else if (tabName === 'schedule') {
                    this.loadScheduleTab();
                } else if (tabName === 'subject-attendance') {
                    this.loadSubjectAttendanceTab();
                }
            }

            loadHomePage() {
                // Update stats based on today's attendance
                const today = new Date().toISOString().split('T')[0];
                const todayAttendance = this.attendance.records.filter(record => 
                    record.date === today && record.type === 'daily'
                );
                
                let presentCount = 0;
                let sickCount = 0;
                let permissionCount = 0;
                let absentCount = 0;
                
                // Reset counts
                this.students.forEach(student => {
                    const record = todayAttendance.find(r => r.studentId == student.id);
                    if (record) {
                        switch(record.status) {
                            case 'present': presentCount++; break;
                            case 'sick': sickCount++; break;
                            case 'permission': permissionCount++; break;
                            case 'absent': absentCount++; break;
                        }
                    } else {
                        absentCount++; // Jika tidak ada record, dianggap alpha
                    }
                });
                
                // Update the dashboard stats
                document.getElementById('presentCount').textContent = presentCount;
                document.getElementById('sickCount').textContent = sickCount;
                document.getElementById('permissionCount').textContent = permissionCount;
                document.getElementById('absentCount').textContent = absentCount;

                // Load today's schedule
                this.loadTodaySchedule();
                
                // Load upcoming assignments for dashboard
                this.loadUpcomingAssignments();
                
                // Load recent activities
                this.loadRecentActivities();
                
                // Load today's duty
                this.loadTodayDuty();
                
                // Load class structure
                this.loadClassStructure();
                
                // Load class gallery
                this.loadClassGallery();
            }

            loadClassStructure() {
                const structureGrid = document.getElementById('structureGrid');
                
                if (this.structure.members.length > 0) {
                    structureGrid.innerHTML = this.structure.members.map(member => `
                        <div class="structure-card">
                            <div class="structure-avatar">
                                ${member.name.split(' ').map(n => n[0]).join('')}
                            </div>
                            <div class="structure-name">${member.name}</div>
                            <div class="structure-role">${member.role}</div>
                            <div class="structure-contact">${member.contact}</div>
                        </div>
                    `).join('');
                } else {
                    structureGrid.innerHTML = `
                        <div class="empty-placeholder">
                            <i class="fas fa-users"></i>
                            <p>Belum ada data struktur kelas.</p>
                        </div>
                    `;
                }
            }

            loadClassGallery() {
                const galleryGrid = document.getElementById('galleryGrid');
                
                if (this.structure.gallery.length > 0) {
                    galleryGrid.innerHTML = this.structure.gallery.map(item => `
                        <div class="gallery-item">
                            <i class="fas fa-image"></i>
                            <div class="gallery-item-title">${item.title}</div>
                        </div>
                    `).join('');
                } else {
                    galleryGrid.innerHTML = `
                        <div class="empty-placeholder">
                            <i class="fas fa-images"></i>
                            <p>Belum ada galeri foto.</p>
                        </div>
                    `;
                }
            }

            loadTodaySchedule() {
                const todaySchedule = document.getElementById('todaySchedule');
                const today = new Date();
                const dayNames = ['Minggu', 'Senin', 'Selasa', 'Rabu', 'Kamis', 'Jumat', 'Sabtu'];
                const todayName = dayNames[today.getDay()];
                
                // Get today's schedule
                const todayLessons = this.schedule[todayName] || [];
                
                if (todayLessons.length > 0) {
                    todaySchedule.innerHTML = todayLessons.map((lesson, index) => {
                        // Determine if this lesson is current, upcoming, or past
                        const now = new Date();
                        const [startTime, endTime] = lesson.time.split('-');
                        const [startHour, startMinute] = startTime.split(':').map(Number);
                        const [endHour, endMinute] = endTime.split(':').map(Number);
                        
                        const lessonStart = new Date();
                        lessonStart.setHours(startHour, startMinute, 0, 0);
                        
                        const lessonEnd = new Date();
                        lessonEnd.setHours(endHour, endMinute, 0, 0);
                        
                        let status = 'akan-datang';
                        if (now >= lessonStart && now <= lessonEnd) {
                            status = 'current';
                        } else if (now > lessonEnd) {
                            status = 'selesai';
                        }
                        
                        // Determine teacher status
                        const teacherStatus = lesson.teacherStatus === 'absent' ? 'Tidak Hadir' : 'Hadir';
                        const teacherStatusClass = lesson.teacherStatus === 'absent' ? 'teacher-absent' : 'teacher-present';
                        
                        return `
                            <div class="enhanced-schedule-item ${status === 'current' ? 'current' : ''}">
                                <div class="schedule-time">${lesson.time}</div>
                                <div class="schedule-details">
                                    <h4>${lesson.subject}</h4>
                                    <p>${lesson.teacher}  ${lesson.room}</p>
                                </div>
                                <div class="schedule-status">
                                    ${teacherStatus}
                                </div>
                                <div class="teacher-status ${teacherStatusClass}">Guru ${teacherStatus}</div>
                                <button class="edit-schedule-btn" onclick="app.editTodaySchedule('${todayName}', ${index})">
                                    <i class="fas fa-edit"></i> Edit
                                </button>
                            </div>
                        `;
                    }).join('');
                } else {
                    todaySchedule.innerHTML = `
                        <div class="empty-placeholder">
                            <i class="fas fa-calendar-times"></i>
                            <p>Tidak ada jadwal untuk hari ini.</p>
                        </div>
                    `;
                }
            }

            loadRecentActivities() {
                const recentActivityList = document.getElementById('recentActivityList');
                
                // Sort activities by time (newest first) and take the 3 most recent
                const recentActivities = [...this.activities]
                    .sort((a, b) => new Date(b.time) - new Date(a.time))
                    .slice(0, 3);
                
                if (recentActivities.length > 0) {
                    recentActivityList.innerHTML = recentActivities.map(activity => {
                        const timeAgo = this.getTimeAgo(new Date(activity.time));
                        
                        return `
                            <div class="activity-item">
                                <div class="activity-icon">
                                    <i class="fas fa-${activity.icon}"></i>
                                </div>
                                <div class="activity-content">
                                    <p>${activity.title}</p>
                                    <span class="activity-time">${timeAgo}  ${activity.description}</span>
                                </div>
                            </div>
                        `;
                    }).join('');
                } else {
                    recentActivityList.innerHTML = `
                        <div class="empty-placeholder">
                            <i class="fas fa-history"></i>
                            <p>Tidak ada aktivitas terbaru.</p>
                        </div>
                    `;
                }
            }

            getTimeAgo(date) {
                const now = new Date();
                const diffMs = now - date;
                const diffMins = Math.floor(diffMs / 60000);
                const diffHours = Math.floor(diffMs / 3600000);
                const diffDays = Math.floor(diffMs / 86400000);
                
                if (diffMins < 1) return 'Baru saja';
                if (diffMins < 60) return `${diffMins} menit lalu`;
                if (diffHours < 24) return `${diffHours} jam lalu`;
                if (diffDays === 1) return 'Kemarin';
                if (diffDays < 7) return `${diffDays} hari lalu`;
                return date.toLocaleDateString('id-ID');
            }

            loadUpcomingAssignments() {
                const dashboardAssignmentsList = document.getElementById('dashboardAssignmentsList');
                const today = new Date();
                
                // Filter assignments that are active or urgent and not completed
                const upcomingAssignments = this.assignments.assignments
                    .filter(assignment => {
                        const deadline = new Date(assignment.deadline);
                        return (assignment.status === 'active' || assignment.status === 'urgent') && deadline >= today;
                    })
                    .sort((a, b) => new Date(a.deadline) - new Date(b.deadline))
                    .slice(0, 5); // Show 5 upcoming assignments

                if (upcomingAssignments.length > 0) {
                    dashboardAssignmentsList.innerHTML = upcomingAssignments.map(assignment => `
                        <div class="enhanced-assignment-item ${assignment.status}">
                            <div class="assignment-subject">${assignment.subject}</div>
                            <div class="assignment-title">${assignment.title}</div>
                            <div class="assignment-deadline">
                                <i class="fas fa-clock"></i>
                                Deadline: ${this.formatDateForDisplay(assignment.deadline)}
                            </div>
                        </div>
                    `).join('');
                } else {
                    dashboardAssignmentsList.innerHTML = `
                        <div class="empty-placeholder">
                            <i class="fas fa-tasks"></i>
                            <p>Tidak ada tugas mendatang.</p>
                        </div>
                    `;
                }
            }

            // Load today's duty
            loadTodayDuty() {
                const todayDutyList = document.getElementById('todayDutyList');
                const today = new Date();
                const dayNames = ['Minggu', 'Senin', 'Selasa', 'Rabu', 'Kamis', 'Jumat', 'Sabtu'];
                const todayName = dayNames[today.getDay()];
                
                // Get today's duty
                const todayDuty = this.duty.schedule.find(duty => duty.day === todayName);
                
                if (todayDuty) {
                    const dutyStudents = todayDuty.students.map(studentId => {
                        const student = this.students.find(s => s.id === studentId);
                        return student ? student.name : 'Tidak diketahui';
                    }).join(', ');
                    
                    todayDutyList.innerHTML = `
                        <div class="enhanced-schedule-item">
                            <div class="schedule-details">
                                <h4>Petugas Piket: ${dutyStudents}</h4>
                                <p>${todayDuty.tasks}</p>
                            </div>
                            <button class="edit-schedule-btn" onclick="app.editDuty(${todayDuty.id})">
                                <i class="fas fa-edit"></i> Edit
                            </button>
                        </div>
                    `;
                } else {
                    todayDutyList.innerHTML = `
                        <div class="empty-placeholder">
                            <i class="fas fa-broom"></i>
                            <p>Tidak ada jadwal piket untuk hari ini.</p>
                        </div>
                    `;
                }
            }

            formatDateForDisplay(dateString) {
                const date = new Date(dateString);
                const today = new Date();
                const diffTime = date - today;
                const diffDays = Math.ceil(diffTime / (1000 * 60 * 60 * 24));

                if (diffDays === 0) {
                    return "Hari Ini";
                } else if (diffDays === 1) {
                    return "Besok";
                } else if (diffDays <= 7) {
                    return `${diffDays} Hari Lagi`;
                } else {
                    return date.toLocaleDateString('id-ID');
                }
            }

            showAttendanceDetails(status) {
                const statusMap = {
                    'present': 'Hadir',
                    'sick': 'Sakit',
                    'permission': 'Izin',
                    'absent': 'Alpha'
                };
                
                const today = new Date().toISOString().split('T')[0];
                const studentsWithStatus = this.attendance.records
                    .filter(record => record.date === today && record.type === 'daily' && record.status === status)
                    .map(record => record.studentName);
                
                if (studentsWithStatus.length > 0) {
                    alert(`Siswa dengan status ${statusMap[status]} hari ini:\n\n${studentsWithStatus.join('\n')}`);
                } else {
                    alert(`Tidak ada siswa dengan status ${statusMap[status]} hari ini.`);
                }
            }

            loadAttendanceTab() {
                const today = new Date().toISOString().split('T')[0];
                document.getElementById('attendanceDate').value = today;
                this.loadAttendanceData(today);
            }

            loadAttendanceData(date) {
                const tableBody = document.getElementById('attendanceTableBody');
                const dayRecords = this.attendance.records.filter(record => 
                    record.date === date && record.type === 'daily'
                );

                // Hitung jumlah kehadiran untuk ringkasan
                let presentCount = 0;
                let sickCount = 0;
                let permissionCount = 0;
                let absentCount = 0;
                
                // Reset counts
                this.students.forEach(student => {
                    const record = dayRecords.find(r => r.studentId == student.id);
                    if (record) {
                        switch(record.status) {
                            case 'present': presentCount++; break;
                            case 'sick': sickCount++; break;
                            case 'permission': permissionCount++; break;
                            case 'absent': absentCount++; break;
                        }
                    } else {
                        absentCount++; // Jika tidak ada record, dianggap alpha
                    }
                });

                const totalStudents = this.students.length;

                // Update ringkasan
                document.getElementById('totalStudentsSummary').textContent = totalStudents;
                document.getElementById('presentCountSummary').textContent = presentCount;
                document.getElementById('absentCountSummary').textContent = sickCount + permissionCount + absentCount;

                // Bangun HTML berdasarkan daftar semua siswa
                const tableRows = this.students.map((student, index) => {
                    // Cari record absensi untuk siswa ini pada tanggal ini
                    const record = dayRecords.find(r => r.studentId == student.id);

                    if (record) {
                        // Jika ditemukan, tampilkan statusnya
                        return `
                            <tr>
                                <td>${index + 1}</td>
                                <td>${record.studentName}</td>
                                <td>${record.nis}</td>
                                <td>
                                    <span class="status-badge status-${record.status}">
                                        ${this.getStatusText(record.status)}
                                    </span>
                                </td>
                                <td>${record.time || 'N/A'}</td>
                                <td>${record.notes || '-'}</td>
                            </tr>
                        `;
                    } else {
                        // Jika tidak ditemukan, tampilkan status "Belum diisi"
                        return `
                            <tr>
                                <td>${index + 1}</td>
                                <td>${student.name}</td>
                                <td>${student.nis}</td>
                                <td><span class="status-badge status-not-filled">Belum diisi</span></td>
                                <td>-</td>
                                <td>-</td>
                            </tr>
                        `;
                    }
                }).join('');

                tableBody.innerHTML = tableRows;
            }

            // Load subject attendance tab
            loadSubjectAttendanceTab() {
                const today = new Date().toISOString().split('T')[0];
                document.getElementById('subjectAttendanceDate').value = today;
                this.loadSubjectAttendance();
            }

            // Load subject attendance data
            loadSubjectAttendance() {
                const date = document.getElementById('subjectAttendanceDate').value;
                const subjectAttendanceGrid = document.getElementById('subjectAttendanceGrid');
                const subjectAttendanceTableBody = document.getElementById('subjectAttendanceTableBody');
                
                // Get subject attendance records for the selected date
                const subjectRecords = this.attendance.records.filter(record => 
                    record.date === date && record.type === 'subject'
                );
                
                // Group by subject
                const subjectGroups = {};
                subjectRecords.forEach(record => {
                    if (!subjectGroups[record.subject]) {
                        subjectGroups[record.subject] = [];
                    }
                    subjectGroups[record.subject].push(record);
                });
                
                // Calculate statistics for each subject
                const subjectStats = {};
                Object.keys(subjectGroups).forEach(subject => {
                    const records = subjectGroups[subject];
                    const totalStudents = this.students.length;
                    
                    subjectStats[subject] = {
                        present: records.filter(r => r.status === 'present').length,
                        sick: records.filter(r => r.status === 'sick').length,
                        permission: records.filter(r => r.status === 'permission').length,
                        absent: totalStudents - (records.filter(r => r.status === 'present').length + 
                                records.filter(r => r.status === 'sick').length + 
                                records.filter(r => r.status === 'permission').length)
                    };
                });
                
                // Display subject attendance cards
                if (Object.keys(subjectStats).length > 0) {
                    subjectAttendanceGrid.innerHTML = Object.keys(subjectStats).map(subject => {
                        const stats = subjectStats[subject];
                        const total = stats.present + stats.sick + stats.permission + stats.absent;
                        
                        return `
                            <div class="subject-attendance-card" onclick="app.showSubjectAttendanceDetails('${subject}', '${date}')">
                                <div class="subject-attendance-header">
                                    <div class="subject-name">${this.getSubjectDisplayName(subject)}</div>
                                    <div class="assignment-status active">${total} Siswa</div>
                                </div>
                                <div class="subject-attendance-stats">
                                    <div class="subject-stat">
                                        <div class="subject-stat-value" style="color: var(--secondary-color);">${stats.present}</div>
                                        <div class="subject-stat-label">Hadir</div>
                                    </div>
                                    <div class="subject-stat">
                                        <div class="subject-stat-value" style="color: var(--warning-color);">${stats.sick}</div>
                                        <div class="subject-stat-label">Sakit</div>
                                    </div>
                                    <div class="subject-stat">
                                        <div class="subject-stat-value" style="color: var(--info-color);">${stats.permission}</div>
                                        <div class="subject-stat-label">Izin</div>
                                    </div>
                                    <div class="subject-stat">
                                        <div class="subject-stat-value" style="color: var(--danger-color);">${stats.absent}</div>
                                        <div class="subject-stat-label">Alpha</div>
                                    </div>
                                </div>
                            </div>
                        `;
                    }).join('');
                } else {
                    subjectAttendanceGrid.innerHTML = `
                        <div class="empty-placeholder">
                            <i class="fas fa-book"></i>
                            <p>Tidak ada data absensi mata pelajaran untuk tanggal ini.</p>
                        </div>
                    `;
                }
                
                // Display subject attendance table
                if (Object.keys(subjectStats).length > 0) {
                    subjectAttendanceTableBody.innerHTML = Object.keys(subjectStats).map((subject, index) => {
                        const stats = subjectStats[subject];
                        const teacher = this.getTeacherBySubject(subject);
                        
                        return `
                            <tr>
                                <td>${index + 1}</td>
                                <td>${this.getSubjectDisplayName(subject)}</td>
                                <td>${teacher ? teacher.name : 'Tidak diketahui'}</td>
                                <td>${stats.present}</td>
                                <td>${stats.sick}</td>
                                <td>${stats.permission}</td>
                                <td>${stats.absent}</td>
                                <td>
                                    <div class="assignment-actions">
                                        <button class="btn-small" onclick="app.showSubjectAttendanceDetails('${subject}', '${date}')">
                                            <i class="fas fa-eye"></i> Detail
                                        </button>
                                        <button class="btn-small" onclick="app.editSubjectAttendance('${subject}', '${date}')">
                                            <i class="fas fa-edit"></i> Edit
                                        </button>
                                    </div>
                                </td>
                            </tr>
                        `;
                    }).join('');
                } else {
                    subjectAttendanceTableBody.innerHTML = `
                        <tr>
                            <td colspan="8" style="text-align: center; padding: 40px;">
                                <div class="empty-placeholder">
                                    <i class="fas fa-book"></i>
                                    <p>Tidak ada data absensi mata pelajaran untuk tanggal ini.</p>
                                </div>
                            </td>
                        </tr>
                    `;
                }
            }

            // Get teacher by subject
            getTeacherBySubject(subject) {
                return this.teachers.find(teacher => 
                    teacher.subject.toLowerCase().includes(subject.toLowerCase()) ||
                    subject.toLowerCase().includes(teacher.subject.toLowerCase())
                );
            }

            // Show subject attendance details
            showSubjectAttendanceDetails(subject, date) {
                const subjectRecords = this.attendance.records.filter(record => 
                    record.date === date && record.type === 'subject' && record.subject === subject
                );
                
                const presentStudents = subjectRecords.filter(r => r.status === 'present').map(r => r.studentName);
                const sickStudents = subjectRecords.filter(r => r.status === 'sick').map(r => r.studentName);
                const permissionStudents = subjectRecords.filter(r => r.status === 'permission').map(r => r.studentName);
                
                const absentStudents = this.students
                    .filter(student => !subjectRecords.find(r => r.studentId === student.id))
                    .map(student => student.name);
                
                let message = `Detail Absensi ${this.getSubjectDisplayName(subject)} - ${date}\n\n`;
                
                if (presentStudents.length > 0) {
                    message += `Hadir (${presentStudents.length}):\n${presentStudents.join('\n')}\n\n`;
                }
                
                if (sickStudents.length > 0) {
                    message += `Sakit (${sickStudents.length}):\n${sickStudents.join('\n')}\n\n`;
                }
                
                if (permissionStudents.length > 0) {
                    message += `Izin (${permissionStudents.length}):\n${permissionStudents.join('\n')}\n\n`;
                }
                
                if (absentStudents.length > 0) {
                    message += `Alpha (${absentStudents.length}):\n${absentStudents.join('\n')}`;
                }
                
                alert(message);
            }

            // Edit subject attendance
            editSubjectAttendance(subject, date) {
                this.showAttendanceModal('subject', subject, date);
            }

            // Load group spinner tab
            loadGroupSpinnerTab() {
                // Display saved groups if available
                if (this.groups.groups && this.groups.groups.length > 0) {
                    this.displayGroups(this.groups.groups);
                }
            }

            // Generate random groups
            generateGroups() {
                const groupCount = parseInt(document.getElementById('groupCount').value);
                const method = document.getElementById('groupMethod').value;
                const includeAbsent = document.getElementById('includeAbsent').value;
                
                // Show spinner
                const spinner = document.getElementById('groupSpinner');
                spinner.style.display = 'flex';
                
                // Get students to include in groups
                let studentsToInclude = [...this.students];
                
                // Exclude absent students if selected
                if (includeAbsent === 'exclude') {
                    const today = new Date().toISOString().split('T')[0];
                    const todayAttendance = this.attendance.records.filter(record => record.date === today && record.type === 'daily');
                    
                    studentsToInclude = studentsToInclude.filter(student => {
                        const record = todayAttendance.find(r => r.studentId == student.id);
                        return record && record.status === 'present';
                    });
                }
                
                // Simulate processing time
                setTimeout(() => {
                    let groups;
                    
                    switch(method) {
                        case 'balanced':
                            groups = this.createBalancedGroups(studentsToInclude, groupCount);
                            break;
                        case 'leader':
                            groups = this.createGroupsWithLeaders(studentsToInclude, groupCount);
                            break;
                        default:
                            groups = this.createRandomGroups(studentsToInclude, groupCount);
                    }
                    
                    // Hide spinner
                    spinner.style.display = 'none';
                    
                    // Display groups
                    this.displayGroups(groups);
                    
                    // Save groups
                    this.groups.groups = groups;
                    this.saveGroups();
                    
                    this.showToast('Kelompok berhasil dibuat!');
                }, 1500);
            }

            // Create random groups
            createRandomGroups(students, groupCount) {
                // Shuffle students array
                const shuffled = [...students].sort(() => 0.5 - Math.random());
                
                // Calculate group sizes
                const baseSize = Math.floor(shuffled.length / groupCount);
                const remainder = shuffled.length % groupCount;
                
                const groups = [];
                let startIndex = 0;
                
                for (let i = 0; i < groupCount; i++) {
                    const groupSize = baseSize + (i < remainder ? 1 : 0);
                    const groupMembers = shuffled.slice(startIndex, startIndex + groupSize);
                    startIndex += groupSize;
                    
                    groups.push({
                        name: `Kelompok ${i + 1}`,
                        members: groupMembers
                    });
                }
                
                return groups;
            }

            // Create balanced groups (by gender)
            createBalancedGroups(students, groupCount) {
                // Separate by gender
                const maleStudents = students.filter(s => s.gender === 'L');
                const femaleStudents = students.filter(s => s.gender === 'P');
                
                // Shuffle each group
                const shuffledMale = [...maleStudents].sort(() => 0.5 - Math.random());
                const shuffledFemale = [...femaleStudents].sort(() => 0.5 - Math.random());
                
                const groups = Array.from({ length: groupCount }, (_, i) => ({
                    name: `Kelompok ${i + 1}`,
                    members: []
                }));
                
                // Distribute male students
                shuffledMale.forEach((student, index) => {
                    groups[index % groupCount].members.push(student);
                });
                
                // Distribute female students
                shuffledFemale.forEach((student, index) => {
                    groups[index % groupCount].members.push(student);
                });
                
                return groups;
            }

            // Create groups with leaders
            createGroupsWithLeaders(students, groupCount) {
                // Get potential leaders (students with good attendance)
                const today = new Date().toISOString().split('T')[0];
                const oneWeekAgo = new Date();
                oneWeekAgo.setDate(oneWeekAgo.getDate() - 7);
                
                const studentAttendanceCount = {};
                this.attendance.records.forEach(record => {
                    const recordDate = new Date(record.date);
                    if (recordDate >= oneWeekAgo && record.status === 'present') {
                        if (!studentAttendanceCount[record.studentId]) {
                            studentAttendanceCount[record.studentId] = 0;
                        }
                        studentAttendanceCount[record.studentId]++;
                    }
                });
                
                // Sort students by attendance (potential leaders first)
                const sortedStudents = [...students].sort((a, b) => {
                    const aCount = studentAttendanceCount[a.id] || 0;
                    const bCount = studentAttendanceCount[b.id] || 0;
                    return bCount - aCount;
                });
                
                const groups = Array.from({ length: groupCount }, (_, i) => ({
                    name: `Kelompok ${i + 1}`,
                    members: []
                }));
                
                // Assign leaders
                sortedStudents.slice(0, groupCount).forEach((student, index) => {
                    groups[index].members.push({
                        ...student,
                        isLeader: true
                    });
                });
                
                // Distribute remaining students
                const remainingStudents = sortedStudents.slice(groupCount);
                const shuffledRemaining = [...remainingStudents].sort(() => 0.5 - Math.random());
                
                shuffledRemaining.forEach((student, index) => {
                    groups[index % groupCount].members.push(student);
                });
                
                return groups;
            }

            // Display groups
            displayGroups(groups) {
                const container = document.getElementById('groupsContainer');
                
                if (groups.length > 0) {
                    container.innerHTML = groups.map(group => `
                        <div class="group-card">
                            <div class="group-header">
                                <div class="group-name">${group.name}</div>
                                <div class="group-member-count">${group.members.length} anggota</div>
                            </div>
                            <div class="group-members">
                                ${group.members.map((member, index) => `
                                    <div class="group-member">
                                        <div class="group-member-avatar">
                                            ${member.name.split(' ').map(n => n[0]).join('')}
                                        </div>
                                        <div>
                                            <div>${member.name}</div>
                                            <div style="font-size: 0.7rem; color: var(--text-light);">${member.nis}</div>
                                        </div>
                                        ${member.isLeader ? `
                                            <div style="margin-left: auto;">
                                                <span class="status-badge status-present" style="font-size: 0.6rem;">Ketua</span>
                                            </div>
                                        ` : ''}
                                    </div>
                                `).join('')}
                            </div>
                        </div>
                    `).join('');
                } else {
                    container.innerHTML = `
                        <div class="empty-placeholder">
                            <i class="fas fa-users"></i>
                            <p>Belum ada kelompok yang dibuat.</p>
                        </div>
                    `;
                }
            }

            // Regenerate groups
            regenerateGroups() {
                this.generateGroups();
            }

            // Export groups
            exportGroups() {
                if (!this.groups.groups || this.groups.groups.length === 0) {
                    this.showToast('Tidak ada kelompok untuk diekspor!', 'error');
                    return;
                }
                
                let csvContent = "data:text/csv;charset=utf-8,";
                csvContent += "PEMBAGIAN KELOMPOK SISWA\n";
                csvContent += `Tanggal: ${new Date().toLocaleDateString('id-ID')}\n\n`;
                
                this.groups.groups.forEach(group => {
                    csvContent += `${group.name}\n`;
                    csvContent += "No,Nama Siswa,NIS,Peran\n";
                    
                    group.members.forEach((member, index) => {
                        const role = member.isLeader ? 'Ketua Kelompok' : 'Anggota';
                        csvContent += `${index + 1},${member.name},${member.nis},${role}\n`;
                    });
                    
                    csvContent += "\n";
                });
                
                const encodedUri = encodeURI(csvContent);
                const link = document.createElement("a");
                link.setAttribute("href", encodedUri);
                link.setAttribute("download", `pembagian_kelompok_${new Date().toISOString().split('T')[0]}.csv`);
                document.body.appendChild(link);
                link.click();
                document.body.removeChild(link);
                
                this.showToast('Kelompok berhasil diekspor!');
            }

            // Load classroom tab
            loadClassroomTab() {
                this.displayClassroom();
            }

            // Display classroom layout
            displayClassroom() {
                const classroomGrid = document.getElementById('classroomGrid');
                const layoutType = document.getElementById('layoutType').value;
                
                // Update classroom layout type
                this.classroom.layout = layoutType;
                this.saveClassroom();
                
                let gridHTML = '';
                
                if (layoutType === 'grid') {
                    // 6x6 grid layout
                    for (let i = 1; i <= 36; i++) {
                        const seat = this.classroom.seats.find(s => s.deskNumber === i);
                        const student = seat && seat.studentId ? this.students.find(s => s.id === seat.studentId) : null;
                        
                        gridHTML += `
                            <div class="classroom-desk ${student ? '' : 'empty'}" onclick="app.selectStudentForSeat(${i})">
                                <div class="desk-number">${i}</div>
                                ${student ? `
                                    <div class="desk-student">${student.name}</div>
                                ` : `
                                    <div class="desk-student">Kosong</div>
                                `}
                            </div>
                        `;
                    }
                } else if (layoutType === 'u-shape') {
                    // U-shape layout (simplified)
                    for (let i = 1; i <= 30; i++) {
                        const seat = this.classroom.seats.find(s => s.deskNumber === i);
                        const student = seat && seat.studentId ? this.students.find(s => s.id === seat.studentId) : null;
                        
                        gridHTML += `
                            <div class="classroom-desk ${student ? '' : 'empty'}" onclick="app.selectStudentForSeat(${i})">
                                <div class="desk-number">${i}</div>
                                ${student ? `
                                    <div class="desk-student">${student.name}</div>
                                ` : `
                                    <div class="desk-student">Kosong</div>
                                `}
                            </div>
                        `;
                    }
                    
                    // Teacher's desk
                    gridHTML += `
                        <div class="classroom-desk teacher">
                            <div class="desk-number">Guru</div>
                            <div class="desk-student">Bu Sari, S.Pd</div>
                        </div>
                    `;
                } else if (layoutType === 'groups') {
                    // Group layout (4 groups of 9)
                    for (let group = 1; group <= 4; group++) {
                        for (let i = 1; i <= 9; i++) {
                            const deskNumber = (group - 1) * 9 + i;
                            const seat = this.classroom.seats.find(s => s.deskNumber === deskNumber);
                            const student = seat && seat.studentId ? this.students.find(s => s.id === seat.studentId) : null;
                            
                            gridHTML += `
                                <div class="classroom-desk ${student ? '' : 'empty'}" onclick="app.selectStudentForSeat(${deskNumber})">
                                    <div class="desk-number">${deskNumber}</div>
                                    ${student ? `
                                        <div class="desk-student">${student.name}</div>
                                    ` : `
                                        <div class="desk-student">Kosong</div>
                                    `}
                                </div>
                            `;
                        }
                    }
                }
                
                classroomGrid.innerHTML = gridHTML;
            }

            // Select student for seat
            selectStudentForSeat(deskNumber) {
                const availableStudents = this.students.filter(student => {
                    // Check if student is already assigned to a seat
                    const assignedSeat = this.classroom.seats.find(seat => seat.studentId === student.id);
                    return !assignedSeat || assignedSeat.deskNumber === deskNumber;
                });
                
                if (availableStudents.length === 0) {
                    this.showToast('Tidak ada siswa yang tersedia!', 'error');
                    return;
                }
                
                const studentNames = availableStudents.map(s => s.name).join('\n');
                const studentId = prompt(`Pilih siswa untuk kursi ${deskNumber}:\n\n${studentNames}`);
                
                if (studentId) {
                    const student = availableStudents.find(s => s.name === studentId);
                    if (student) {
                        // Remove student from previous seat if any
                        const previousSeat = this.classroom.seats.find(seat => seat.studentId === student.id);
                        if (previousSeat) {
                            previousSeat.studentId = null;
                            previousSeat.studentName = null;
                        }
                        
                        // Assign student to new seat
                        const seat = this.classroom.seats.find(s => s.deskNumber === deskNumber);
                        if (seat) {
                            seat.studentId = student.id;
                            seat.studentName = student.name;
                        }
                        
                        this.saveClassroom();
                        this.displayClassroom();
                        this.showToast(`Siswa ${student.name} ditempatkan di kursi ${deskNumber}`);
                    }
                }
            }

            // Randomize seats
            randomizeSeats() {
                if (confirm('Apakah Anda yakin ingin mengacak tempat duduk?')) {
                    // Reset all seats
                    this.classroom.seats.forEach(seat => {
                        seat.studentId = null;
                        seat.studentName = null;
                    });
                    
                    // Shuffle students
                    const shuffledStudents = [...this.students].sort(() => 0.5 - Math.random());
                    
                    // Assign students to seats
                    shuffledStudents.forEach((student, index) => {
                        if (index < this.classroom.seats.length) {
                            this.classroom.seats[index].studentId = student.id;
                            this.classroom.seats[index].studentName = student.name;
                        }
                    });
                    
                    this.saveClassroom();
                    this.displayClassroom();
                    this.showToast('Tempat duduk berhasil diacak!');
                }
            }

            // Reset seats
            resetSeats() {
                if (confirm('Apakah Anda yakin ingin mereset semua tempat duduk?')) {
                    this.classroom.seats.forEach(seat => {
                        seat.studentId = null;
                        seat.studentName = null;
                    });
                    
                    this.saveClassroom();
                    this.displayClassroom();
                    this.showToast('Tempat duduk berhasil direset!');
                }
            }

            // Change layout
            changeLayout() {
                this.displayClassroom();
            }

            // Load duty tab
            loadDutyTab() {
                this.loadDutySchedule();
            }

            // Load duty schedule
            loadDutySchedule() {
                const dutyTableBody = document.getElementById('dutyTableBody');
                const weekValue = document.getElementById('dutyWeek').value;
                
                if (this.duty.schedule.length > 0) {
                    dutyTableBody.innerHTML = this.duty.schedule.map(duty => {
                        const dutyStudents = duty.students.map(studentId => {
                            const student = this.students.find(s => s.id === studentId);
                            return student ? student.name : 'Tidak diketahui';
                        }).join(', ');
                        
                        return `
                            <tr>
                                <td>${duty.day}</td>
                                <td>${dutyStudents}</td>
                                <td>${duty.tasks}</td>
                                <td>
                                    <div class="assignment-actions">
                                        <button class="btn-small" onclick="app.editDuty(${duty.id})">
                                            <i class="fas fa-edit"></i> Edit
                                        </button>
                                        <button class="btn-small" onclick="app.deleteDuty(${duty.id})">
                                            <i class="fas fa-trash"></i> Hapus
                                        </button>
                                    </div>
                                </td>
                            </tr>
                        `;
                    }).join('');
                } else {
                    dutyTableBody.innerHTML = `
                        <tr>
                            <td colspan="4" style="text-align: center; padding: 40px;">
                                <div class="empty-placeholder">
                                    <i class="fas fa-broom"></i>
                                    <p>Belum ada jadwal piket.</p>
                                </div>
                            </td>
                        </tr>
                    `;
                }
            }

            // Show duty modal
            showDutyModal(dutyId = null) {
                const modal = document.getElementById('dutyModal');
                const title = document.getElementById('dutyModalTitle');
                const form = document.getElementById('dutyForm');
                
                // Populate students dropdown
                const dutyStudentsSelect = document.getElementById('dutyStudents');
                dutyStudentsSelect.innerHTML = this.students.map(student => 
                    `<option value="${student.id}">${student.name}</option>`
                ).join('');
                
                if (dutyId) {
                    // Edit mode
                    title.textContent = 'Edit Jadwal Piket';
                    const duty = this.duty.schedule.find(d => d.id === dutyId);
                    if (duty) {
                        document.getElementById('dutyId').value = duty.id;
                        document.getElementById('dutyDay').value = duty.day;
                        
                        // Select students
                        duty.students.forEach(studentId => {
                            const option = dutyStudentsSelect.querySelector(`option[value="${studentId}"]`);
                            if (option) option.selected = true;
                        });
                        
                        document.getElementById('dutyTasks').value = duty.tasks;
                    }
                } else {
                    // Add mode
                    title.textContent = 'Tambah Jadwal Piket';
                    form.reset();
                }
                
                modal.style.display = 'block';
            }

            // Edit duty
            editDuty(dutyId) {
                this.showDutyModal(dutyId);
            }

            // Delete duty
            deleteDuty(dutyId) {
                if (confirm('Apakah Anda yakin ingin menghapus jadwal piket ini?')) {
                    this.duty.schedule = this.duty.schedule.filter(d => d.id !== dutyId);
                    this.saveDuty();
                    this.loadDutySchedule();
                    this.loadTodayDuty();
                    this.showToast('Jadwal piket berhasil dihapus!');
                }
            }

            // Submit duty
            submitDuty() {
                const id = document.getElementById('dutyId').value;
                const day = document.getElementById('dutyDay').value;
                const students = Array.from(document.getElementById('dutyStudents').selectedOptions).map(option => parseInt(option.value));
                const tasks = document.getElementById('dutyTasks').value;
                
                if (id) {
                    // Edit existing duty
                    const dutyIndex = this.duty.schedule.findIndex(d => d.id == id);
                    if (dutyIndex !== -1) {
                        this.duty.schedule[dutyIndex] = {
                            id: parseInt(id),
                            day,
                            students,
                            tasks
                        };
                    }
                } else {
                    // Add new duty
                    const newDuty = {
                        id: Date.now(),
                        day,
                        students,
                        tasks
                    };
                    
                    this.duty.schedule.push(newDuty);
                }
                
                this.saveDuty();
                this.closeModal('dutyModal');
                this.loadDutySchedule();
                this.loadTodayDuty();
                this.showToast('Jadwal piket berhasil disimpan!');
            }

            // Generate duty schedule automatically
            generateDutySchedule() {
                if (confirm('Apakah Anda yakin ingin membuat jadwal piket otomatis?')) {
                    // Clear existing schedule
                    this.duty.schedule = [];
                    
                    const days = ['Senin', 'Selasa', 'Rabu', 'Kamis', 'Jumat'];
                    const tasks = [
                        'Menyapu lantai, membersihkan papan tulis',
                        'Mengepel lantai, merapikan buku',
                        'Membersihkan jendela, menyiram tanaman',
                        'Menyapu halaman, merapikan meja guru',
                        'Membersihkan rak buku, menata kursi'
                    ];
                    
                    // Shuffle students
                    const shuffledStudents = [...this.students].sort(() => 0.5 - Math.random());
                    
                    // Assign 3 students per day
                    days.forEach((day, index) => {
                        const startIndex = index * 3;
                        const dayStudents = shuffledStudents.slice(startIndex, startIndex + 3).map(s => s.id);
                        
                        this.duty.schedule.push({
                            id: Date.now() + index,
                            day,
                            students: dayStudents,
                            tasks: tasks[index]
                        });
                    });
                    
                    this.saveDuty();
                    this.loadDutySchedule();
                    this.loadTodayDuty();
                    this.showToast('Jadwal piket otomatis berhasil dibuat!');
                }
            }

            loadScheduleTab() {
                const scheduleGrid = document.getElementById('scheduleGrid');
                const times = ['07:00-08:30', '08:30-10:00', '10:00-11:30', '11:30-13:00', '13:00-14:30'];
                const days = ['Senin', 'Selasa', 'Rabu', 'Kamis', 'Jumat', 'Sabtu'];
                let scheduleHTML = '';
                
                times.forEach(time => {
                    scheduleHTML += `<div class="schedule-cell time">${time}</div>`;
                    days.forEach(day => {
                        const lessons = this.schedule[day]?.filter(lesson => lesson.time === time) || [];
                        scheduleHTML += `
                            <div class="schedule-cell">
                                ${lessons.map((lesson, index) => `
                                    <div class="schedule-lesson" onclick="app.showLessonDetails('${lesson.subject}', '${lesson.teacher}', '${lesson.room}')">
                                        <h5>${lesson.subject}</h5>
                                        <p>${lesson.teacher}</p>
                                        <small>${lesson.room}</small>
                                        ${lesson.teacherStatus === 'absent' ? 
                                            `<div class="teacher-status teacher-absent">Guru Tidak Hadir</div>` : 
                                            `<div class="teacher-status teacher-present">Guru Hadir</div>`
                                        }
                                        <div class="schedule-lesson-actions">
                                            <button class="schedule-edit-btn" onclick="app.editSchedule('${day}', ${index}, event)">
                                                <i class="fas fa-edit"></i>
                                            </button>
                                        </div>
                                    </div>
                                `).join('')}
                            </div>
                        `;
                    });
                });
                scheduleGrid.innerHTML = scheduleHTML;
            }

            showLessonDetails(subject, teacher, room) {
                alert(`Detail Pelajaran:\n\nMata Pelajaran: ${subject}\nGuru: ${teacher}\nRuangan: ${room}`);
            }

            // Show schedule modal
            showScheduleModal() {
                const modal = document.getElementById('scheduleModal');
                const title = document.getElementById('scheduleModalTitle');
                const form = document.getElementById('scheduleForm');
                
                title.textContent = 'Tambah Jadwal Baru';
                form.reset();
                
                modal.style.display = 'block';
            }

            // Edit schedule
            editSchedule(day, index, event) {
                event.stopPropagation();
                
                const modal = document.getElementById('scheduleModal');
                const title = document.getElementById('scheduleModalTitle');
                const form = document.getElementById('scheduleForm');
                
                title.textContent = 'Edit Jadwal Pelajaran';
                
                const lesson = this.schedule[day][index];
                
                document.getElementById('scheduleId').value = `${day}-${index}`;
                document.getElementById('scheduleDay').value = day;
                document.getElementById('scheduleTime').value = lesson.time;
                document.getElementById('scheduleSubject').value = lesson.subject;
                document.getElementById('scheduleTeacher').value = lesson.teacher;
                document.getElementById('scheduleRoom').value = lesson.room;
                document.getElementById('teacherStatus').value = lesson.teacherStatus || 'present';
                
                modal.style.display = 'block';
            }

            // Edit today's schedule
            editTodaySchedule(day, index) {
                const modal = document.getElementById('scheduleModal');
                const title = document.getElementById('scheduleModalTitle');
                const form = document.getElementById('scheduleForm');
                
                title.textContent = 'Edit Jadwal Hari Ini';
                
                const lesson = this.schedule[day][index];
                
                document.getElementById('scheduleId').value = `${day}-${index}`;
                document.getElementById('scheduleDay').value = day;
                document.getElementById('scheduleTime').value = lesson.time;
                document.getElementById('scheduleSubject').value = lesson.subject;
                document.getElementById('scheduleTeacher').value = lesson.teacher;
                document.getElementById('scheduleRoom').value = lesson.room;
                document.getElementById('teacherStatus').value = lesson.teacherStatus || 'present';
                
                modal.style.display = 'block';
            }

            // Submit schedule
            submitSchedule() {
                const id = document.getElementById('scheduleId').value;
                const day = document.getElementById('scheduleDay').value;
                const time = document.getElementById('scheduleTime').value;
                const subject = document.getElementById('scheduleSubject').value;
                const teacher = document.getElementById('scheduleTeacher').value;
                const room = document.getElementById('scheduleRoom').value;
                const teacherStatus = document.getElementById('teacherStatus').value;
                
                if (id) {
                    // Edit existing schedule
                    const [scheduleDay, scheduleIndex] = id.split('-');
                    if (this.schedule[scheduleDay] && this.schedule[scheduleDay][scheduleIndex]) {
                        // If day changed, remove from old day and add to new day
                        if (scheduleDay !== day) {
                            this.schedule[scheduleDay].splice(scheduleIndex, 1);
                            if (!this.schedule[day]) {
                                this.schedule[day] = [];
                            }
                            this.schedule[day].push({
                                time,
                                subject,
                                teacher,
                                room,
                                teacherStatus
                            });
                        } else {
                            // Update in same day
                            this.schedule[day][scheduleIndex] = {
                                time,
                                subject,
                                teacher,
                                room,
                                teacherStatus
                            };
                        }
                    }
                } else {
                    // Add new schedule
                    if (!this.schedule[day]) {
                        this.schedule[day] = [];
                    }
                    this.schedule[day].push({
                        time,
                        subject,
                        teacher,
                        room,
                        teacherStatus
                    });
                }
                
                // Sort schedule by time
                Object.keys(this.schedule).forEach(day => {
                    this.schedule[day].sort((a, b) => {
                        const aTime = a.time.split('-')[0];
                        const bTime = b.time.split('-')[0];
                        return aTime.localeCompare(bTime);
                    });
                });
                
                this.saveSchedule();
                this.closeModal('scheduleModal');
                this.loadScheduleTab();
                this.loadTodaySchedule();
                this.showToast('Jadwal berhasil disimpan!');
            }

            loadStudentsTab() {
                const studentsGrid = document.getElementById('studentsGrid');
                studentsGrid.innerHTML = this.students.map(student => `
                    <div class="student-card" onclick="app.showStudentDetails(${student.id})">
                        <div class="student-avatar-large">
                            ${student.name.split(' ').map(n => n[0]).join('')}
                        </div>
                        <h4>${student.name}</h4>
                        <div class="student-nis">NIS: ${student.nis}</div>
                        <div class="student-contact">
                            <div><i class="fas fa-envelope"></i> ${student.email}</div>
                            <div><i class="fas fa-phone"></i> ${student.phone}</div>
                        </div>
                    </div>
                `).join('');
            }

            showStudentDetails(studentId) {
                const student = this.students.find(s => s.id === studentId);
                if (student) {
                    alert(`Detail Siswa:\n\nNama: ${student.name}\nNIS: ${student.nis}\nEmail: ${student.email}\nTelepon: ${student.phone}`);
                }
            }

            loadTeachersTab() {
                const teachersGrid = document.getElementById('teachersGrid');
                teachersGrid.innerHTML = this.teachers.map(teacher => `
                    <div class="teacher-card" onclick="app.showTeacherDetails(${teacher.id})">
                        <div class="teacher-avatar">
                            ${teacher.name.split(' ').map(n => n[0]).join('')}
                        </div>
                        <div class="teacher-info">
                            <h4>${teacher.name}</h4>
                            <div class="teacher-subject">${teacher.subject}</div>
                            <div class="teacher-qualification">${teacher.qualification}</div>
                            <div class="teacher-contact">
                                <small><i class="fas fa-envelope"></i> ${teacher.email}</small><br>
                                <small><i class="fas fa-phone"></i> ${teacher.phone}</small>
                            </div>
                        </div>
                    </div>
                `).join('');
            }

            showTeacherDetails(teacherId) {
                const teacher = this.teachers.find(t => t.id === teacherId);
                if (teacher) {
                    alert(`Detail Guru:\n\nNama: ${teacher.name}\nMata Pelajaran: ${teacher.subject}\nKualifikasi: ${teacher.qualification}\nEmail: ${teacher.email}\nTelepon: ${teacher.phone}`);
                }
            }

            loadAssignmentsTab() {
                const assignmentsList = document.getElementById('assignmentsList');
                const assignments = this.assignments.assignments.length > 0 ? 
                    this.assignments.assignments : 
                    [
                        {
                            id: 1,
                            subject: 'Matematika',
                            title: 'Tugas Trigonometri - Bab 5',
                            deadline: '2024-10-12',
                            status: 'urgent',
                            description: 'Kerjakan soal nomor 1-10 halaman 125',
                            type: 'pr'
                        },
                        {
                            id: 2,
                            subject: 'Fisika',
                            title: 'Laporan Praktikum Hukum Newton',
                            deadline: '2024-10-15',
                            status: 'active',
                            description: 'Buat laporan hasil praktikum kelompok',
                            type: 'proyek'
                        },
                        {
                            id: 3,
                            subject: 'Kimia',
                            title: 'Tabel Periodik Unsur',
                            deadline: '2024-10-08',
                            status: 'completed',
                            description: 'Hafalkan 20 unsur pertama tabel periodik',
                            type: 'ulangan'
                        },
                        {
                            id: 4,
                            subject: 'Bahasa Indonesia',
                            title: 'Analisis Puisi Chairil Anwar',
                            deadline: '2024-10-18',
                            status: 'active',
                            description: 'Analisis 3 puisi karya Chairil Anwar',
                            type: 'pr'
                        },
                        {
                            id: 5,
                            subject: 'Biologi',
                            title: 'Laporan Sistem Pencernaan',
                            deadline: '2024-10-20',
                            status: 'active',
                            description: 'Buat laporan tentang sistem pencernaan manusia',
                            type: 'proyek'
                        }
                    ];
                
                this.assignments.assignments = assignments;
                this.saveAssignments();
                
                assignmentsList.innerHTML = assignments.map(assignment => `
                    <div class="assignment-item-detailed ${assignment.status}">
                        <div class="assignment-header">
                            <div class="assignment-subject">${assignment.subject}</div>
                            <div class="assignment-status ${assignment.status}">
                                ${this.getAssignmentStatusText(assignment.status)}
                            </div>
                        </div>
                        <div class="assignment-title">${assignment.title}</div>
                        <div class="assignment-description">${assignment.description}</div>
                        <div class="assignment-footer">
                            <div class="assignment-deadline">
                                <i class="fas fa-clock"></i>
                                Deadline: ${new Date(assignment.deadline).toLocaleDateString('id-ID')}
                            </div>
                            <div class="assignment-type">
                                <i class="fas fa-tag"></i>
                                ${this.getAssignmentTypeText(assignment.type)}
                            </div>
                        </div>
                        <div class="assignment-actions">
                            <button class="btn-small" onclick="app.editAssignment(${assignment.id})">
                                <i class="fas fa-edit"></i> Edit
                            </button>
                            <button class="btn-small" onclick="app.deleteAssignment(${assignment.id})">
                                <i class="fas fa-trash"></i> Hapus
                            </button>
                        </div>
                    </div>
                `).join('');
            }

            showAssignmentModal(assignmentId = null) {
                const modal = document.getElementById('assignmentModal');
                const title = document.getElementById('assignmentModalTitle');
                const form = document.getElementById('assignmentForm');
                
                if (assignmentId) {
                    // Edit mode
                    title.textContent = 'Edit Tugas';
                    const assignment = this.assignments.assignments.find(a => a.id === assignmentId);
                    if (assignment) {
                        document.getElementById('assignmentId').value = assignment.id;
                        document.getElementById('assignmentSubject').value = assignment.subject;
                        document.getElementById('assignmentTitle').value = assignment.title;
                        document.getElementById('assignmentDescription').value = assignment.description;
                        document.getElementById('assignmentDeadline').value = assignment.deadline;
                        document.getElementById('assignmentType').value = assignment.type;
                        document.getElementById('assignmentStatus').value = assignment.status;
                    }
                } else {
                    // Add mode
                    title.textContent = 'Tambah Tugas Baru';
                    form.reset();
                    // Set default deadline to tomorrow
                    const tomorrow = new Date();
                    tomorrow.setDate(tomorrow.getDate() + 1);
                    document.getElementById('assignmentDeadline').value = tomorrow.toISOString().split('T')[0];
                }
                
                modal.style.display = 'block';
            }

            editAssignment(assignmentId) {
                this.showAssignmentModal(assignmentId);
            }

            deleteAssignment(assignmentId) {
                if (confirm('Apakah Anda yakin ingin menghapus tugas ini?')) {
                    this.assignments.assignments = this.assignments.assignments.filter(a => a.id !== assignmentId);
                    this.saveAssignments();
                    this.loadAssignmentsTab();
                    this.loadUpcomingAssignments(); // Update dashboard assignments
                    this.showToast('Tugas berhasil dihapus!');
                }
            }

            showAttendanceModal(type = 'daily', subject = null, date = null) {
                const modal = document.getElementById('attendanceModal');
                const title = document.getElementById('attendanceModalTitle');
                const form = document.getElementById('attendanceForm');
                const subjectField = document.getElementById('subjectField');
                
                // Set attendance type
                document.getElementById('attendanceType').value = type;
                
                if (type === 'daily') {
                    title.textContent = 'Input Absensi Harian';
                    subjectField.style.display = 'none';
                } else {
                    title.textContent = 'Input Absensi Mata Pelajaran';
                    subjectField.style.display = 'block';
                    
                    if (subject) {
                        document.getElementById('modalSubject').value = subject;
                    }
                }
                
                // Set today's date
                const today = new Date().toISOString().split('T')[0];
                document.getElementById('modalDate').value = date || today;
                
                modal.style.display = 'block';
                
                // Load students for attendance - menampilkan semua siswa
                this.loadAttendanceStudents();
            }

            closeModal(modalId) {
                document.getElementById(modalId).style.display = 'none';
            }

            loadAttendanceStudents() {
                const modalDate = document.getElementById('modalDate').value;
                const modalSubject = document.getElementById('modalSubject').value;
                const attendanceType = document.getElementById('attendanceType').value;
                const container = document.getElementById('attendanceStudentsList');

                // Ambil data absensi sebelumnya untuk tanggal dan mata pelajaran ini
                const previousAttendance = this.attendance.records.filter(record => 
                    record.date === modalDate && 
                    record.type === attendanceType &&
                    (attendanceType === 'daily' || record.subject === modalSubject)
                );

                container.innerHTML = this.students.map(student => {
                    // Cek apakah ada data absensi sebelumnya untuk siswa ini
                    const previousRecord = previousAttendance.find(record => record.studentId == student.id);
                    const previousStatus = previousRecord ? previousRecord.status : null;

                    return `
                        <div class="attendance-student-item" data-student-id="${student.id}" ${previousStatus ? `data-selected-status="${previousStatus}"` : ''}>
                            <div class="student-attendance-info">
                                <div class="student-avatar-small">
                                    ${student.name.split(' ').map(n => n[0]).join('')}
                                </div>
                                <div>
                                    <div class="student-name">${student.name}</div>
                                    <div class="student-nis">NIS: ${student.nis}</div>
                                </div>
                            </div>
                            <div class="attendance-options-small">
                                <button type="button" class="attendance-btn-small present ${previousStatus === 'present' ? 'active' : ''}" data-status="present">H</button>
                                <button type="button" class="attendance-btn-small sick ${previousStatus === 'sick' ? 'active' : ''}" data-status="sick">S</button>
                                <button type="button" class="attendance-btn-small permission ${previousStatus === 'permission' ? 'active' : ''}" data-status="permission">I</button>
                                <button type="button" class="attendance-btn-small absent ${previousStatus === 'absent' ? 'active' : ''}" data-status="absent">A</button>
                            </div>
                        </div>
                    `;
                }).join('');

                // Tambahkan event listeners untuk tombol absensi
                container.querySelectorAll('.attendance-btn-small').forEach(btn => {
                    btn.addEventListener('click', (e) => {
                        const studentItem = e.target.closest('.attendance-student-item');
                        const status = e.target.dataset.status;
                        // Hapus kelas aktif dari semua tombol dalam item siswa ini
                        studentItem.querySelectorAll('.attendance-btn-small').forEach(b => {
                            b.classList.remove('active');
                        });
                        // Tambahkan kelas aktif ke tombol yang diklik
                        e.target.classList.add('active');
                        // Simpan status yang dipilih ke atribut data
                        studentItem.dataset.selectedStatus = status;
                    });
                });
            }

            submitAttendance() {
                const date = document.getElementById('modalDate').value;
                const subject = document.getElementById('modalSubject').value;
                const attendanceType = document.getElementById('attendanceType').value;
                const studentItems = document.querySelectorAll('.attendance-student-item');

                if (studentItems.length === 0) {
                    this.showToast('Tidak ada siswa untuk diinputkan absensinya!', 'error');
                    return;
                }

                // Hapus data absensi sebelumnya untuk tanggal dan mata pelajaran yang sama
                this.attendance.records = this.attendance.records.filter(record => 
                    !(record.date === date && 
                      record.type === attendanceType &&
                      (attendanceType === 'daily' || record.subject === subject))
                );

                // Loop semua siswa untuk menyimpan statusnya
                studentItems.forEach(item => {
                    const studentId = item.dataset.studentId;
                    const selectedStatus = item.dataset.selectedStatus || 'absent'; // Default ke absent jika tidak dipilih
                    const student = this.students.find(s => s.id == studentId);

                    // Tambahkan record baru
                    const newRecord = {
                        id: Date.now() + studentId,
                        date: date,
                        type: attendanceType,
                        studentId: studentId,
                        studentName: student.name,
                        nis: student.nis,
                        status: selectedStatus,
                        time: new Date().toLocaleTimeString('id-ID', { hour: '2-digit', minute: '2-digit' }),
                        timestamp: new Date().toISOString()
                    };

                    // Jika absensi mata pelajaran, tambahkan subject
                    if (attendanceType === 'subject') {
                        newRecord.subject = subject;
                    }

                    this.attendance.records.push(newRecord);
                });

                // Add activity
                if (attendanceType === 'daily') {
                    this.addActivity('attendance', 'Absensi harian diinput', `${date}`);
                } else {
                    this.addActivity('attendance', 'Absensi mata pelajaran diinput', `${this.getSubjectDisplayName(subject)} - ${date}`);
                }

                this.saveAttendance();
                this.closeModal('attendanceModal');
                
                // Update data berdasarkan jenis absensi
                if (attendanceType === 'daily') {
                    this.loadAttendanceData(date);
                    this.loadHomePage(); // Update dashboard stats
                } else {
                    this.loadSubjectAttendance();
                }
                
                this.showToast('Absensi berhasil disimpan!');
            }

            addActivity(type, title, description) {
                const newActivity = {
                    id: Date.now(),
                    type: type,
                    title: title,
                    description: description,
                    time: new Date().toISOString(),
                    icon: this.getActivityIcon(type)
                };
                
                this.activities.unshift(newActivity);
                this.saveActivities();
            }

            getActivityIcon(type) {
                const iconMap = {
                    'attendance': 'clipboard-check',
                    'assignment': 'tasks',
                    'announcement': 'comment',
                    'group': 'users'
                };
                return iconMap[type] || 'info-circle';
            }

            submitAssignment() {
                const id = document.getElementById('assignmentId').value;
                const subject = document.getElementById('assignmentSubject').value;
                const title = document.getElementById('assignmentTitle').value;
                const description = document.getElementById('assignmentDescription').value;
                const deadline = document.getElementById('assignmentDeadline').value;
                const type = document.getElementById('assignmentType').value;
                const status = document.getElementById('assignmentStatus').value;
                
                if (id) {
                    // Edit existing assignment
                    const assignmentIndex = this.assignments.assignments.findIndex(a => a.id == id);
                    if (assignmentIndex !== -1) {
                        this.assignments.assignments[assignmentIndex] = {
                            id: parseInt(id),
                            subject,
                            title,
                            description,
                            deadline,
                            type,
                            status,
                            updated: new Date().toISOString()
                        };
                    }
                } else {
                    // Add new assignment
                    const newAssignment = {
                        id: Date.now(),
                        subject: subject,
                        title: title,
                        description: description,
                        deadline: deadline,
                        type: type,
                        status: status,
                        created: new Date().toISOString()
                    };

                    if (!this.assignments.assignments) {
                        this.assignments.assignments = [];
                    }
                    
                    this.assignments.assignments.push(newAssignment);
                    
                    // Add activity
                    this.addActivity('assignment', 'Tugas baru ditambahkan', `${subject} - ${title}`);
                }
                
                this.saveAssignments();
                this.closeModal('assignmentModal');
                this.loadAssignmentsTab();
                this.loadUpcomingAssignments(); // Update dashboard assignments
                this.showToast('Tugas berhasil disimpan!');
            }

            filterStudents(query) {
                const filteredStudents = this.students.filter(student => 
                    student.name.toLowerCase().includes(query.toLowerCase()) ||
                    student.nis.includes(query)
                );
                const studentsGrid = document.getElementById('studentsGrid');
                studentsGrid.innerHTML = filteredStudents.map(student => `
                    <div class="student-card" onclick="app.showStudentDetails(${student.id})">
                        <div class="student-avatar-large">
                            ${student.name.split(' ').map(n => n[0]).join('')}
                        </div>
                        <h4>${student.name}</h4>
                        <div class="student-nis">NIS: ${student.nis}</div>
                        <div class="student-contact">
                            <div><i class="fas fa-envelope"></i> ${student.email}</div>
                            <div><i class="fas fa-phone"></i> ${student.phone}</div>
                        </div>
                    </div>
                `).join('');
            }

            filterAssignments(filter) {
                const assignmentsList = document.getElementById('assignmentsList');
                let filteredAssignments = this.assignments.assignments;
                
                if (filter !== 'all') {
                    filteredAssignments = filteredAssignments.filter(a => a.status === filter);
                }
                
                assignmentsList.innerHTML = filteredAssignments.map(assignment => `
                    <div class="assignment-item-detailed ${assignment.status}">
                        <div class="assignment-header">
                            <div class="assignment-subject">${assignment.subject}</div>
                            <div class="assignment-status ${assignment.status}">
                                ${this.getAssignmentStatusText(assignment.status)}
                            </div>
                        </div>
                        <div class="assignment-title">${assignment.title}</div>
                        <div class="assignment-description">${assignment.description}</div>
                        <div class="assignment-footer">
                            <div class="assignment-deadline">
                                <i class="fas fa-clock"></i>
                                Deadline: ${new Date(assignment.deadline).toLocaleDateString('id-ID')}
                            </div>
                            <div class="assignment-type">
                                <i class="fas fa-tag"></i>
                                ${this.getAssignmentTypeText(assignment.type)}
                            </div>
                        </div>
                        <div class="assignment-actions">
                            <button class="btn-small" onclick="app.editAssignment(${assignment.id})">
                                <i class="fas fa-edit"></i> Edit
                            </button>
                            <button class="btn-small" onclick="app.deleteAssignment(${assignment.id})">
                                <i class="fas fa-trash"></i> Hapus
                            </button>
                        </div>
                    </div>
                `).join('');
            }

            editAnnouncement() {
                const modal = document.getElementById('announcementModal');
                document.getElementById('announcementTextInput').value = this.announcement.text;
                modal.style.display = 'block';
            }

            saveAnnouncement() {
                const newText = document.getElementById('announcementTextInput').value;
                this.announcement.text = newText;
                this.saveAnnouncementData();
                this.updateAnnouncement();
                this.closeModal('announcementModal');
                this.showToast('Pengumuman berhasil diperbarui!');
            }

            updateAnnouncement() {
                const announcementEl = document.getElementById('announcementText');
                if (announcementEl) {
                    // Add animation
                    announcementEl.style.opacity = '0';
                    setTimeout(() => {
                        announcementEl.textContent = this.announcement.text;
                        announcementEl.style.opacity = '1';
                    }, 300);
                }
            }

            exportAttendance() {
                const date = document.getElementById('attendanceDate').value;
                const dayRecords = this.attendance.records.filter(record => 
                    record.date === date && record.type === 'daily'
                );
                
                let csvContent = "data:text/csv;charset=utf-8,";
                csvContent += "No,Nama Siswa,NIS,Status,Waktu,Keterangan\n";
                
                this.students.forEach((student, index) => {
                    const record = dayRecords.find(r => r.studentId == student.id);
                    const status = record ? this.getStatusText(record.status) : 'Belum diisi';
                    const time = record ? record.time : '-';
                    const notes = record ? (record.notes || '-') : '-';
                    
                    csvContent += `${index + 1},${student.name},${student.nis},${status},${time},${notes}\n`;
                });
                
                const encodedUri = encodeURI(csvContent);
                const link = document.createElement("a");
                link.setAttribute("href", encodedUri);
                link.setAttribute("download", `absensi_${date}.csv`);
                document.body.appendChild(link);
                link.click();
                document.body.removeChild(link);
            }

            getStatusText(status) {
                const statusMap = {
                    'present': 'Hadir',
                    'sick': 'Sakit',
                    'permission': 'Izin',
                    'absent': 'Alpha'
                };
                return statusMap[status] || status;
            }

            getAssignmentStatusText(status) {
                const statusMap = {
                    'urgent': 'Mendesak',
                    'active': 'Aktif',
                    'completed': 'Selesai'
                };
                return statusMap[status] || status;
            }

            getAssignmentTypeText(type) {
                const typeMap = {
                    'pr': 'Pekerjaan Rumah',
                    'ulangan': 'Ulangan',
                    'proyek': 'Proyek',
                    'lainnya': 'Lainnya'
                };
                return typeMap[type] || type;
            }

            // Get subject display name
            getSubjectDisplayName(subjectKey) {
                const subjectMap = {
                    'matematika': 'Matematika',
                    'fisika': 'Fisika',
                    'kimia': 'Kimia',
                    'biologi': 'Biologi',
                    'bindo': 'Bahasa Indonesia',
                    'bing': 'Bahasa Inggris',
                    'tik': 'TIK Lanjut',
                    'sosiologi': 'Sosiologi Lanjut',
                    'ekonomi': 'Ekonomi Lanjut',
                    'bahasa_jepang': 'Bahasa Jepang Lanjut'
                };
                return subjectMap[subjectKey] || subjectKey;
            }

            // Get week number
            getWeekNumber(date) {
                const firstDayOfYear = new Date(date.getFullYear(), 0, 1);
                const pastDaysOfYear = (date - firstDayOfYear) / 86400000;
                return Math.ceil((pastDaysOfYear + firstDayOfYear.getDay() + 1) / 7);
            }

            // Toast notification
            showToast(message, type = 'success') {
                const toast = document.createElement('div');
                toast.className = 'toast';
                toast.textContent = message;
                
                if (type === 'error') {
                    toast.classList.add('error');
                }
                
                document.body.appendChild(toast);
                
                // Show toast
                setTimeout(() => {
                    toast.classList.add('show');
                }, 100);
                
                // Hide toast after 3 seconds
                setTimeout(() => {
                    toast.classList.remove('show');
                    setTimeout(() => {
                        if (document.body.contains(toast)) {
                            document.body.removeChild(toast);
                        }
                    }, 400);
                }, 3000);
            }
        }

        // Initialize the application
        const app = new ClassWebsite();

        // Loading screen animation
        window.addEventListener('load', function() {
            const loadingScreen = document.getElementById('loadingScreen');
            const loadingProgress = document.getElementById('loadingProgress');
            const classWebsite = document.getElementById('classWebsite');
            
            // Simulate loading progress
            let progress = 0;
            const interval = setInterval(() => {
                progress += Math.random() * 15;
                if (progress >= 100) {
                    progress = 100;
                    clearInterval(interval);
                    
                    // Hide loading screen and show website
                    setTimeout(() => {
                        loadingScreen.classList.add('hidden');
                        classWebsite.classList.add('loaded');
                    }, 500);
                }
                loadingProgress.style.width = `${progress}%`;
            }, 200);
        });

        // Close modal when clicking outside
        window.onclick = function(event) {
            const modals = document.getElementsByClassName('modal');
            for (let modal of modals) {
                if (event.target === modal) {
                    modal.style.display = 'none';
                }
            }
            
            // Hide search suggestions when clicking outside
            const searchSuggestions = document.getElementById('searchSuggestions');
            const headerSearch = document.getElementById('headerSearch');
            
            if (!headerSearch.contains(event.target) && !searchSuggestions.contains(event.target)) {
                searchSuggestions.classList.remove('active');
            }
        }

        // Set default date to today
        window.addEventListener('DOMContentLoaded', function() {
            const today = new Date().toISOString().split('T')[0];
            document.getElementById('attendanceDate').value = today;
            document.getElementById('subjectAttendanceDate').value = today;
        });
    </script>
</body>
</html>
